labs(x = '',
y = 'Млрд долл.',
title = 'Совокупный экспорт Россией услуг по \n транспортировке грузов')
(plot_1 + plot_2) / plot_3 +
plot_layout(guides = 'collect', heights = c(2,1)) &
theme(legend.position = 'top',
legend.title = element_blank(),
legend.text = element_text(size = 8))
plot_3 <-
totals_plt %>%
ggplot(aes(x = date, y = value, color = name)) +
geom_line(show.legend = F, alpha = 0.9) +
geom_point(alpha = 0.4, show.legend = F) +
scale_color_manual(values = colors_plt_3) +
theme_minimal(base_family = 'HSE Sans') +
theme(legend.position = 'none',
axis.title.y = element_text(size = 8),
plot.title = element_text(hjust = 0.5)) +
labs(x = '',
y = 'Млрд долл.',
title = 'Совокупный экспорт Россией услуг по \n транспортировке грузов')
(plot_1 + plot_2) / plot_3 +
plot_layout(guides = 'collect', heights = c(2,1)) &
theme(legend.position = 'top',
legend.title = element_blank(),
legend.text = element_text(size = 8))
plot_3 <-
totals_plt %>%
ggplot(aes(x = date, y = value, color = name)) +
geom_line(show.legend = F, alpha = 0.9) +
geom_point(alpha = 0.4, show.legend = F) +
scale_color_manual(values = colors_plt_3) +
theme_minimal(base_family = 'HSE Sans') +
theme(legend.position = 'none',
axis.title.y = element_text(size = 8),
plot.title = element_text(hjust = 0.5),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.minor.y = element_blank()
axis.title.x = element_blank()) +
plot_3 <-
totals_plt %>%
ggplot(aes(x = date, y = value, color = name)) +
geom_line(show.legend = F, alpha = 0.9) +
geom_point(alpha = 0.4, show.legend = F) +
scale_color_manual(values = colors_plt_3) +
theme_minimal(base_family = 'HSE Sans') +
theme(legend.position = 'none',
axis.title.y = element_text(size = 8),
plot.title = element_text(hjust = 0.5),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.minor.y = element_blank(),
axis.title.x = element_blank()) +
labs(y = 'Млрд долл.',
title = 'Совокупный экспорт Россией услуг по \n транспортировке грузов')
(plot_1 + plot_2) / plot_3 +
plot_layout(guides = 'collect', heights = c(2,1)) &
theme(legend.position = 'top',
legend.title = element_blank(),
legend.text = element_text(size = 8))
plot_3 <-
totals_plt %>%
ggplot(aes(x = date, y = value, color = name)) +
geom_line(show.legend = F, alpha = 0.9) +
geom_point(alpha = 0.4, show.legend = F) +
scale_color_manual(values = colors_plt_3) +
theme_minimal(base_family = 'HSE Sans') +
theme(legend.position = 'none',
axis.title.y = element_text(size = 8),
plot.title = element_text(hjust = 0.5, face = 'bolditalic'),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.minor.y = element_blank(),
axis.title.x = element_blank()) +
labs(y = 'Млрд долл.',
title = 'Совокупный экспорт Россией услуг по \n транспортировке грузов')
(plot_1 + plot_2) / plot_3 +
plot_layout(guides = 'collect', heights = c(2,1)) &
theme(legend.position = 'top',
legend.title = element_blank(),
legend.text = element_text(size = 8))
plot_3 <-
totals_plt %>%
ggplot(aes(x = date, y = value, color = name)) +
geom_line(show.legend = F, alpha = 0.9) +
geom_point(alpha = 0.4, show.legend = F) +
scale_color_manual(values = colors_plt_3) +
theme_minimal(base_family = 'HSE Sans') +
theme(legend.position = 'none',
axis.title.y = element_text(size = 8),
plot.title = element_text(hjust = 0.5, face = bolditalic),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.minor.y = element_blank(),
axis.title.x = element_blank()) +
labs(y = 'Млрд долл.',
title = 'Совокупный экспорт Россией услуг по \n транспортировке грузов')
plot_3 <-
totals_plt %>%
ggplot(aes(x = date, y = value, color = name)) +
geom_line(show.legend = F, alpha = 0.9) +
geom_point(alpha = 0.4, show.legend = F) +
scale_color_manual(values = colors_plt_3) +
theme_minimal(base_family = 'HSE Sans') +
theme(legend.position = 'none',
axis.title.y = element_text(size = 8),
plot.title = element_text(hjust = 0.5, face = 'bolditalic'),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.minor.y = element_blank(),
axis.title.x = element_blank()) +
labs(y = 'Млрд долл.',
title = 'Совокупный экспорт Россией услуг по \n транспортировке грузов')
(plot_1 + plot_2) / plot_3 +
plot_layout(guides = 'collect', heights = c(2,1)) &
theme(legend.position = 'top',
legend.title = element_blank(),
legend.text = element_text(size = 8))
plot_3 <-
totals_plt %>%
ggplot(aes(x = date, y = value, color = name)) +
geom_line(show.legend = F, alpha = 0.9) +
geom_point(alpha = 0.4, show.legend = F) +
scale_color_manual(values = colors_plt_3) +
theme_minimal(base_family = 'HSE Sans') +
theme(legend.position = 'none',
axis.title.y = element_text(size = 8),
plot.title = element_text(hjust = 0.5, face = 'bold'),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.minor.y = element_blank(),
axis.title.x = element_blank()) +
labs(y = 'Млрд долл.',
title = 'Совокупный экспорт Россией услуг по \n транспортировке грузов')
(plot_1 + plot_2) / plot_3 +
plot_layout(guides = 'collect', heights = c(2,1)) &
theme(legend.position = 'top',
legend.title = element_blank(),
legend.text = element_text(size = 8))
plot_3 / (plot_1 + plot_2) +
plot_layout(guides = 'collect', heights = c(2,1)) &
theme(legend.position = 'bottom',
legend.title = element_blank(),
legend.text = element_text(size = 8))
plot_3 / (plot_1 + plot_2) +
plot_layout(guides = 'collect', heights = c(1,2)) &
theme(legend.position = 'bottom',
legend.title = element_blank(),
legend.text = element_text(size = 8))
plot_3 / (plot_1 + plot_2) +
plot_layout(guides = 'collect', heights = c(1,2)) &
theme(legend.position = 'bottom',
legend.title = element_blank(),
legend.text = element_text(size = 8),
legend.box = element_rect(size = 2))
plot_3 / (plot_1 + plot_2) +
plot_layout(guides = 'collect', heights = c(1,2)) &
theme(legend.position = 'bottom',
legend.title = element_blank(),
legend.text = element_text(size = 8),
legend.box = element_rect(linewidth = 2))
plot_3 / (plot_1 + plot_2) +
plot_layout(guides = 'collect', heights = c(1,2)) &
theme(legend.position = 'bottom',
legend.title = element_blank(),
legend.text = element_text(size = 8),
legend.box = element_grob(size = 2))
plot_3 / (plot_1 + plot_2) +
plot_layout(guides = 'collect', heights = c(1,2)) &
theme(legend.position = 'bottom',
legend.title = element_blank(),
legend.text = element_text(size = 8),
legend.key.size = 2)
plot_3 / (plot_1 + plot_2) +
plot_layout(guides = 'collect', heights = c(1,2)) &
theme(legend.position = 'bottom',
legend.title = element_blank(),
legend.text = element_text(size = 8),
legend.key.size = 1)
plot_3 / (plot_1 + plot_2) +
plot_layout(guides = 'collect', heights = c(1,2)) &
theme(legend.position = 'bottom',
legend.title = element_blank(),
legend.text = element_text(size = 8),
legend.key = element_rect(size = 2))
plot_3 / (plot_1 + plot_2) +
plot_layout(guides = 'collect', heights = c(1,2)) &
theme(legend.position = 'bottom',
legend.title = element_blank(),
legend.text = element_text(size = 8),
legend.key = element_rect(size = 1))
plot_3 / (plot_1 + plot_2) +
plot_layout(guides = 'collect', heights = c(1,2)) &
theme(legend.position = 'bottom',
legend.title = element_blank(),
legend.text = element_text(size = 8),
legend.key = element_blank(size = 1))
plot_3 / (plot_1 + plot_2) +
plot_layout(guides = 'collect', heights = c(1,2)) &
theme(legend.position = 'bottom',
legend.title = element_blank(),
legend.text = element_text(size = 8),
legend.key = element_blank())
plot_3 / (plot_1 + plot_2) +
plot_layout(guides = 'collect', heights = c(1,2)) &
theme(legend.position = 'bottom',
legend.title = element_blank(),
legend.text = element_text(size = 8),
legend.key = element_rect(size = 0.5))
plot_3 / (plot_1 + plot_2) +
plot_layout(guides = 'collect', heights = c(1,2)) &
theme(legend.position = 'bottom',
legend.title = element_blank(),
legend.text = element_text(size = 8),
legend.key = element_rect(size = 1))
plot_3 / (plot_1 + plot_2) +
plot_layout(guides = 'collect', heights = c(1,2)) &
theme(legend.position = 'bottom',
legend.title = element_blank(),
legend.text = element_text(size = 8),
legend.key = element_rect(size = 1),
legend.box = element_blank())
plot_3 / (plot_1 + plot_2) +
plot_layout(guides = 'collect', heights = c(1,2)) &
theme(legend.position = 'bottom',
legend.title = element_blank(),
legend.text = element_text(size = 8),
legend.key = element_rect(size = 1),
legend.key.size = unit(1, cm)
)
plot_3 / (plot_1 + plot_2) +
plot_layout(guides = 'collect', heights = c(1,2)) &
theme(legend.position = 'bottom',
legend.title = element_blank(),
legend.text = element_text(size = 8),
legend.key = element_rect(size = 1),
legend.key.size = unit(1, 'cm')
)
plot_3 / (plot_1 + plot_2) +
plot_layout(guides = 'collect', heights = c(1,2)) &
theme(legend.position = 'bottom',
legend.title = element_blank(),
legend.text = element_text(size = 8),
legend.key = element_rect(size = 1),
legend.key.size = unit(0.4, 'cm')
)
plot_3 / (plot_1 + plot_2) +
plot_layout(guides = 'collect', heights = c(1,2)) &
theme(legend.position = 'bottom',
legend.title = element_blank(),
legend.text = element_text(size = 8),
legend.key = element_rect(size = 1, alpha = 0.9),
legend.key.size = unit(0.4, 'cm')
)
plot_3 / (plot_1 + plot_2) +
plot_layout(guides = 'collect', heights = c(2,5)) &
theme(legend.position = 'bottom',
legend.title = element_blank(),
legend.text = element_text(size = 8),
legend.key = element_rect(size = 1),
legend.key.size = unit(0.4, 'cm')
)
plot_3 <-
totals_plt %>%
ggplot(aes(x = date, y = value, color = name)) +
geom_line(show.legend = F, alpha = 0.9) +
geom_point(alpha = 0.4, show.legend = F) +
scale_color_manual(values = colors_plt_3) +
theme_minimal(base_family = 'HSE Sans') +
theme(legend.position = 'none',
axis.title.y = element_text(size = 8),
plot.title = element_text(hjust = 0.5, face = 'bold'),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.minor.y = element_blank(),
axis.title.x = element_blank()) +
labs(y = 'Млрд долл.',
title = 'Российский экспорт услуг по \n транспортировке грузов')
plot_3 / (plot_1 + plot_2) +
plot_layout(guides = 'collect', heights = c(2,5)) &
theme(legend.position = 'bottom',
legend.title = element_blank(),
legend.text = element_text(size = 8),
legend.key = element_rect(size = 1),
legend.key.size = unit(0.4, 'cm')
)
plot_3 <-
totals_plt %>%
ggplot(aes(x = date, y = value, color = name)) +
geom_line(show.legend = F, alpha = 0.9) +
geom_point(alpha = 0.4, show.legend = F) +
scale_color_manual(values = colors_plt_3) +
theme_minimal(base_family = 'HSE Sans') +
theme(legend.position = 'none',
axis.title.y = element_text(size = 8),
plot.title = element_text(hjust = 0.5, face = 'bold'),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.minor.y = element_blank(),
axis.title.x = element_blank()) +
labs(y = 'Млрд долл.',
title = 'Российский экспорт услуг по транспортировке грузов')
plot_3 / (plot_1 + plot_2) +
plot_layout(guides = 'collect', heights = c(2,5)) &
theme(legend.position = 'bottom',
legend.title = element_blank(),
legend.text = element_text(size = 8),
legend.key = element_rect(size = 1),
legend.key.size = unit(0.4, 'cm')
)
plot_3 <-
totals_plt %>%
ggplot(aes(x = date, y = value, color = name)) +
geom_line(show.legend = F, alpha = 0.9) +
geom_point(alpha = 0.4, show.legend = F) +
scale_color_manual(values = colors_plt_3) +
theme_minimal(base_family = 'HSE Sans') +
theme(legend.position = 'none',
axis.title.y = element_text(size = 8),
plot.title = element_text(hjust = 0.5, face = 'bold'),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.minor.y = element_blank(),
axis.title.x = element_blank()) +
labs(y = 'Млрд долл.',
title = 'Российский экспорт услуг по \n транспортировке грузов')
plot_3 / (plot_1 + plot_2) +
plot_layout(guides = 'collect', heights = c(2,5)) &
theme(legend.position = 'bottom',
legend.title = element_blank(),
legend.text = element_text(size = 8),
legend.key = element_rect(size = 1),
legend.key.size = unit(0.4, 'cm')
)
make_donut_coords <- function(df, cat, percent){
df %>%
arrange(desc(cat)) %>%
mutate(ypos = cumsum(percent) - 0.5*percent ) %>% # координаты для подписей
mutate(ymax = cumsum(percent)) %>%
mutate(ymin = c(0, head(ymax, n=-1))
) %>%
mutate(label_pos = (ymax + ymin) / 2) %>%
mutate(percent_label = paste0(percent, "%")) # формат подписей
}
data_1 <- make_donut_coords(data_percents_21, cat, percent)
data_2 <- make_donut_coords(data_percents_22, cat, percent)
plot_1 <-
data_1 %>%
ggplot(aes(ymax = ymax, ymin = ymin, xmax = 4, xmin = 3, fill = cat)) +
geom_rect() +
geom_text(x=1.7, aes(y=label_pos, label=percent_label), size=size_text, family = 'HSE Sans', color = colors_text) +
coord_polar(theta = 'y') +
annotate('text', x = -1, y = 1, label = '2021', family = 'HSE Sans', fontface = 'bold', size = size_center, alpha = 0.4) +
scale_fill_manual(values = c(colors)) +
theme_void(base_family = 'HSE Sans') +
#theme(legend.position = 'bottom') +
xlim(c(-1, 4))
plot_2 <-
data_2 %>%
ggplot(aes(ymax = ymax, ymin = ymin, xmax = 4, xmin = 3, fill = cat)) +
geom_rect() +
geom_text(x=1.7, aes(y=label_pos, label=percent_label), size=size_text, family = 'HSE Sans', color = colors_text) +
coord_polar(theta = 'y') +
annotate('text', x = -1, y = 1, label = '2022', family = 'HSE Sans', fontface = 'bold', size = size_center, alpha = 0.4) +
scale_fill_manual(values = c(colors)) +
theme_void(base_family = 'HSE Sans') +
#theme(legend.position = 'bottom') +
xlim(c(-1, 4))
plot_3 / (plot_1 + plot_2) +
plot_layout(guides = 'collect', heights = c(2,5)) &
theme(legend.position = 'bottom',
legend.title = element_blank(),
legend.text = element_text(size = 8),
legend.key = element_rect(size = 1),
legend.key.size = unit(0.4, 'cm')
)
plot_1 <-
data_1 %>%
ggplot(aes(ymax = ymax, ymin = ymin, xmax = 4, xmin = 3, fill = cat)) +
geom_rect() +
geom_text(x=1.4, aes(y=label_pos, label=percent_label), size=size_text, family = 'HSE Sans', color = colors_text) +
coord_polar(theta = 'y') +
annotate('text', x = -1, y = 1, label = '2021', family = 'HSE Sans', fontface = 'bold', size = size_center, alpha = 0.4) +
scale_fill_manual(values = c(colors)) +
theme_void(base_family = 'HSE Sans') +
#theme(legend.position = 'bottom') +
xlim(c(-1, 4))
plot_2 <-
data_2 %>%
ggplot(aes(ymax = ymax, ymin = ymin, xmax = 4, xmin = 3, fill = cat)) +
geom_rect() +
geom_text(x=1.4, aes(y=label_pos, label=percent_label), size=size_text, family = 'HSE Sans', color = colors_text) +
coord_polar(theta = 'y') +
annotate('text', x = -1, y = 1, label = '2022', family = 'HSE Sans', fontface = 'bold', size = size_center, alpha = 0.4) +
scale_fill_manual(values = c(colors)) +
theme_void(base_family = 'HSE Sans') +
#theme(legend.position = 'bottom') +
xlim(c(-1, 4))
plot_3 / (plot_1 + plot_2) +
plot_layout(guides = 'collect', heights = c(2,5)) &
theme(legend.position = 'bottom',
legend.title = element_blank(),
legend.text = element_text(size = 8),
legend.key = element_rect(size = 1),
legend.key.size = unit(0.4, 'cm')
)
plot_1 <-
data_1 %>%
ggplot(aes(ymax = ymax, ymin = ymin, xmax = 4, xmin = 3, fill = cat)) +
geom_rect() +
geom_text(x=1.9, aes(y=label_pos, label=percent_label), size=size_text, family = 'HSE Sans', color = colors_text) +
coord_polar(theta = 'y') +
annotate('text', x = -1, y = 1, label = '2021', family = 'HSE Sans', fontface = 'bold', size = size_center, alpha = 0.4) +
scale_fill_manual(values = c(colors)) +
theme_void(base_family = 'HSE Sans') +
#theme(legend.position = 'bottom') +
xlim(c(-1, 4))
plot_2 <-
data_2 %>%
ggplot(aes(ymax = ymax, ymin = ymin, xmax = 4, xmin = 3, fill = cat)) +
geom_rect() +
geom_text(x=1.9, aes(y=label_pos, label=percent_label), size=size_text, family = 'HSE Sans', color = colors_text) +
coord_polar(theta = 'y') +
annotate('text', x = -1, y = 1, label = '2022', family = 'HSE Sans', fontface = 'bold', size = size_center, alpha = 0.4) +
scale_fill_manual(values = c(colors)) +
theme_void(base_family = 'HSE Sans') +
#theme(legend.position = 'bottom') +
xlim(c(-1, 4))
plot_3 / (plot_1 + plot_2) +
plot_layout(guides = 'collect', heights = c(2,5)) &
theme(legend.position = 'bottom',
legend.title = element_blank(),
legend.text = element_text(size = 8),
legend.key = element_rect(size = 1),
legend.key.size = unit(0.4, 'cm')
)
size_header = 8 # размер заголовка
size_text = 2 # размер названий и подписей
size_center = 8
label_position = 2.1
colors <- c('#CEB09F','#9B1631','#71797E','#0A99C3', '#040273')
colors_text <- c('#040273', '#0A99C3', '#71797E','#9B1631', '#CEB09F')
plot_1 <-
data_1 %>%
ggplot(aes(ymax = ymax, ymin = ymin, xmax = 4, xmin = 3, fill = cat)) +
geom_rect() +
geom_text(x=label_position, aes(y=label_pos, label=percent_label), size=size_text, family = 'HSE Sans', color = colors_text) +
coord_polar(theta = 'y') +
annotate('text', x = -1, y = 1, label = '2021', family = 'HSE Sans', fontface = 'bold', size = size_center, alpha = 0.4) +
scale_fill_manual(values = c(colors)) +
theme_void(base_family = 'HSE Sans') +
#theme(legend.position = 'bottom') +
xlim(c(-1, 4))
plot_2 <-
data_2 %>%
ggplot(aes(ymax = ymax, ymin = ymin, xmax = 4, xmin = 3, fill = cat)) +
geom_rect() +
geom_text(x = label_position, aes(y = label_pos, label = percent_label), size = size_text, family = 'HSE Sans', color = colors_text) +
coord_polar(theta = 'y') +
annotate('text', x = -1, y = 1, label = '2022', family = 'HSE Sans', fontface = 'bold', size = size_center, alpha = 0.4) +
scale_fill_manual(values = c(colors)) +
theme_void(base_family = 'HSE Sans') +
#theme(legend.position = 'bottom') +
xlim(c(-1, 4))
plot_3 / (plot_1 + plot_2) +
plot_layout(guides = 'collect', heights = c(2,5)) &
theme(legend.position = 'bottom',
legend.title = element_blank(),
legend.text = element_text(size = 8),
legend.key = element_rect(size = 1),
legend.key.size = unit(0.4, 'cm')
)
ggsave(export_trans.svg)
ggsave('export_trans.svg')
plot_1 <-
data_1 %>%
ggplot(aes(ymax = ymax, ymin = ymin, xmax = 4, xmin = 3, fill = cat)) +
geom_rect(alpha = 0.8) +
geom_text(x=label_position, aes(y=label_pos, label=percent_label), size=size_text, family = 'HSE Sans', color = colors_text) +
coord_polar(theta = 'y') +
annotate('text', x = -1, y = 1, label = '2021', family = 'HSE Sans', fontface = 'bold', size = size_center, alpha = 0.4) +
scale_fill_manual(values = c(colors)) +
theme_void(base_family = 'HSE Sans') +
#theme(legend.position = 'bottom') +
xlim(c(-1, 4))
plot_2 <-
data_2 %>%
ggplot(aes(ymax = ymax, ymin = ymin, xmax = 4, xmin = 3, fill = cat)) +
geom_rect(alpha = 0.8) +
geom_text(x = label_position, aes(y = label_pos, label = percent_label), size = size_text, family = 'HSE Sans', color = colors_text) +
coord_polar(theta = 'y') +
annotate('text', x = -1, y = 1, label = '2022', family = 'HSE Sans', fontface = 'bold', size = size_center, alpha = 0.4) +
scale_fill_manual(values = c(colors)) +
theme_void(base_family = 'HSE Sans') +
#theme(legend.position = 'bottom') +
xlim(c(-1, 4))
plot_3 / (plot_1 + plot_2) +
plot_layout(guides = 'collect', heights = c(2,5)) &
theme(legend.position = 'bottom',
legend.title = element_blank(),
legend.text = element_text(size = 8),
legend.key = element_rect(size = 1),
legend.key.size = unit(0.4, 'cm')
)
ggsave('export_trans.svg')
plot_1 + plot_2 +
plot_layout(guides = 'collect') &
theme(legend.position = 'bottom',
legend.title = element_blank(),
legend.text = element_text(size = 8))
ggsave('export_21_22.svg')
