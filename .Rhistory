theme_minimal(base_family = 'Yeseva One') +
theme(plot.title = element_text(size = 30, hjust = 0.5),
plot.subtitle = element_text(size = 25),
axis.text = element_text(size = 18),
axis.title = element_text(size = 18),
axis.ticks = element_blank(),
panel.background = element_blank()) +
#shadow_mark(alpha = alpha/4, color = alpha("grey", .25)) +
guides(fill = 'none') +
ease_aes('linear') +
transition_time(variable)
x <- rnorm(mean = 1, sd = 2, 1000)
y <- 3 + 2*x + rnorm(mean = 0, sd = 2, 1000)
lm(y ~ x)
x <- rnorm(mean = 1, sd = 2, 1000)
y <- 3 + 2*x + rnorm(mean = 0, sd = 2, 1000)
lm(y ~ x)
library(reshape2)
df <- data_frame(x = x,
alpha_plus_x = 3.002 + x*2.042) %>%
melt()
df$variable <- c(rep(1, 1000), rep(2, 1000))
df %>%
ggplot(aes(x = value)) +
geom_density(fill = '#e5b9ad', color = '#e5b9ad', alpha = .5) +
geom_density(data = tibble(y), aes(x = y), fill = 'lightgreen', color = 'skyblue', alpha = 0.4) +
labs(x = 'Значения', y = '',
title = 'Функция плотности') +
theme_minimal(base_family = 'Yeseva One') +
theme(plot.title = element_text(size = 30, hjust = 0.5),
plot.subtitle = element_text(size = 25),
axis.text = element_text(size = 18),
axis.title = element_text(size = 18),
axis.ticks = element_blank(),
panel.background = element_blank()) +
#shadow_mark(alpha = alpha/4, color = alpha("grey", .25)) +
guides(fill = 'none') +
ease_aes('linear') +
transition_time(variable)
library(sysfonts)
library(showtext)
showtext.auto()
library(sysfonts)
library(showtext)
showtext.auto()
font.add.google('Yeseva One')
font_add_google('Yeseva One')
df %>%
ggplot(aes(x = value)) +
geom_density(fill = '#e5b9ad', color = '#e5b9ad', alpha = .5) +
geom_density(data = tibble(y), aes(x = y), fill = 'lightgreen', color = 'skyblue', alpha = 0.4) +
labs(x = 'Значения', y = '',
title = 'Линейная модель и функции плотности') +
theme_minimal(base_family = 'Yeseva One') +
theme(plot.title = element_text(size = 30, hjust = 0.5),
plot.subtitle = element_text(size = 25),
axis.text = element_text(size = 18),
axis.title = element_text(size = 18),
axis.ticks = element_blank(),
panel.background = element_blank()) +
#shadow_mark(alpha = alpha/4, color = alpha("grey", .25)) +
guides(fill = 'none') +
ease_aes('linear') +
transition_time(variable)
anim_save(filename = 'dists_get_closer.gif')
df %>%
ggplot(aes(x = value)) +
geom_density(fill = '#e5b9ad', color = '#e5b9ad', alpha = .5) +
geom_density(data = tibble(y), aes(x = y), fill = 'lightgreen', color = 'skyblue', alpha = 0.4) +
labs(x = 'Значения', y = '',
title = 'Линейная модель и функции плотности') +
theme_minimal(base_family = 'Yeseva One') +
theme(plot.title = element_text(size = 20, hjust = 0.5),
plot.subtitle = element_text(size = 25),
axis.text = element_text(size = 18),
axis.title = element_text(size = 18),
axis.ticks = element_blank(),
panel.background = element_blank()) +
#shadow_mark(alpha = alpha/4, color = alpha("grey", .25)) +
guides(fill = 'none') +
ease_aes('linear') +
transition_time(variable)
anim_save(filename = 'dists_get_closer.gif')
df %>%
ggplot(aes(x = value)) +
geom_density(fill = '#e5b9ad', color = '#e5b9ad', alpha = .5) +
geom_density(data = tibble(y), aes(x = y), fill = 'lightgreen', color = 'skyblue', alpha = 0.4) +
labs(x = 'Значения', y = '',
title = 'Линейная модель и функции плотности') +
theme_minimal(base_family = 'Yeseva One') +
theme(plot.title = element_text(size = 15, hjust = 0.5),
plot.subtitle = element_text(size = 15),
axis.text = element_text(size = 13),
axis.title = element_text(size = 14),
axis.ticks = element_blank(),
panel.background = element_blank()) +
#shadow_mark(alpha = alpha/4, color = alpha("grey", .25)) +
guides(fill = 'none') +
ease_aes('linear') +
transition_time(variable)
anim_save(filename = 'dists_get_closer.gif')
model <- lm(y ~ x)
model[1]
model[1,1]
model[,1]
model$coefficients[1]
library(tidyverse)
library(gganimate)
library(sysfonts)
library(showtext)
library(hrbrthemes)
showtext.auto()
font_add_google('Yeseva One')
font_add_google('Lobster')
price <- data$sellingprice %>%
na.omit() %>%
as.numeric() %>%
data.frame() %>%
set_names('price')
odometer <- data$odometer %>%
na.omit() %>%
as.numeric() %>%
data.frame() %>%
set_names('odometer')
price <- data$sellingprice %>%
na.omit() %>%
as.numeric()
odometer <- data$odometer %>%
na.omit() %>%
as.numeric()
price(mean)
hist(price)
hist(odometer)
hist(odometer, nbins = 50)
hist(odometer,breaks = 50)
mean(odometer)
mean(price)
model <- lm(price ~ odometer)
length(price)
length(odometer)
dat <- data %>%
na.omit() %>%
select(sellingprice, odometer)
model <- lm(dat, price ~ odometer)
model <- lm(data = dat, price ~ odometer)
model <- lm(data = dat, sellingprice ~ odometer)
dat_1 <- data_frame(x = dat$odometer,
alpha_plus_x = model$coefficients[1] + dat$odometer*model$coefficients[2]) %>%
melt()
length(dat)
length(dat$sellingprice)
dat_1$variable <- c(rep(1, length(dat$sellingprice)), rep(2, length(dat$sellingprice)))
dat_1 %>%
ggplot(aes(x = value)) +
geom_density(fill = '#e5b9ad', color = '#e5b9ad', alpha = .5) +
geom_density(data = dat, aes(x = sellingprice), fill = 'lightgreen', color = 'skyblue', alpha = 0.4) +
labs(x = 'Значения', y = '',
title = 'Линейная модель и функции плотности') +
theme_minimal(base_family = 'Yeseva One') +
theme(plot.title = element_text(size = 15, hjust = 0.5),
plot.subtitle = element_text(size = 15),
axis.text = element_text(size = 13),
axis.title = element_text(size = 14),
axis.ticks = element_blank(),
panel.background = element_blank()) +
guides(fill = 'none') +
ease_aes('linear') +
transition_time(variable)
dat_1 %>%
ggplot(aes(x = value)) +
geom_density(fill = '#e5b9ad', color = '#e5b9ad', alpha = .5) +
geom_density(data = dat, aes(x = sellingprice), fill = 'lightgreen', color = 'skyblue', alpha = 0.4) +
labs(x = 'Значения', y = '',
title = 'Линейная модель и функции плотности') +
theme_minimal(base_family = 'Yeseva One') +
theme(plot.title = element_text(size = 15, hjust = 0.5),
plot.subtitle = element_text(size = 15),
axis.text = element_text(size = 13),
axis.title = element_text(size = 14),
axis.ticks = element_blank(),
panel.background = element_blank()) +
guides(fill = 'none') +
ease_aes('linear') +
transition_time(variable) +
xlim(0, 100000)
dat_1 %>%
ggplot(aes(x = value)) +
geom_density(fill = '#e5b9ad', color = '#e5b9ad', alpha = .5) +
geom_density(data = dat, aes(x = sellingprice), fill = 'lightgreen', color = 'skyblue', alpha = 0.4) +
labs(x = 'Значения', y = '',
title = 'Линейная модель и функции плотности') +
theme_minimal(base_family = 'Yeseva One') +
theme(plot.title = element_text(size = 15, hjust = 0.5),
plot.subtitle = element_text(size = 15),
axis.text = element_text(size = 13),
axis.title = element_text(size = 14),
axis.ticks = element_blank(),
panel.background = element_blank()) +
guides(fill = 'none') +
ease_aes('linear') +
transition_time(variable) +
xlim(0, 75000)
anim_save(filename = 'dists_get_closer_2.gif')
dat_1 %>%
ggplot(aes(x = value)) +
geom_density(fill = '#e5b9ad', color = '#e5b9ad', alpha = .5) +
geom_density(data = dat, aes(x = sellingprice), fill = 'lightgreen', color = 'skyblue', alpha = 0.4) +
labs(x = 'Значения', y = '',
title = 'Линейная модель и функции плотности') +
theme_minimal(base_family = 'Yeseva One') +
theme(plot.title = element_text(size = 14, hjust = 0.5),
plot.subtitle = element_text(size = 15),
axis.text = element_text(size = 13),
axis.title = element_text(size = 13),
axis.ticks = element_blank(),
panel.background = element_blank()) +
guides(fill = 'none') +
ease_aes('linear') +
transition_time(variable) +
xlim(0, 75000)
anim_save(filename = 'dists_get_closer_2.gif')
dat$odometer %>% log() %>% density %>% plot()
dat$sellingprice %>% log() %>% density %>% plot()
dat <- dat %>%
mutate(odometer = log(ofometer),
sellingprice = log(sellingprice)
)
dat <- dat %>%
mutate(odometer = log(odometer),
sellingprice = log(sellingprice)
)
dat_1 <- data_frame(x = dat$odometer,
alpha_plus_x = model$coefficients[1] + dat$odometer*model$coefficients[2]) %>%
melt()
dat_1$variable <- c(rep(1, length(dat$sellingprice)), rep(2, length(dat$sellingprice)))
dat_1 %>%
ggplot(aes(x = value)) +
geom_density(fill = '#e5b9ad', color = '#e5b9ad', alpha = .5) +
geom_density(data = dat, aes(x = sellingprice), fill = 'lightgreen', color = 'skyblue', alpha = 0.4) +
labs(x = 'Значения', y = '',
title = 'Линейная модель и функции плотности') +
theme_minimal(base_family = 'Yeseva One') +
theme(plot.title = element_text(size = 14, hjust = 0.5),
plot.subtitle = element_text(size = 15),
axis.text = element_text(size = 13),
axis.title = element_text(size = 13),
axis.ticks = element_blank(),
panel.background = element_blank()) +
guides(fill = 'none') +
ease_aes('linear') +
transition_time(variable)
model <- lm(data = dat, sellingprice ~ odometer)
dat_1 <- data_frame(x = dat$odometer,
alpha_plus_x = model$coefficients[1] + dat$odometer*model$coefficients[2]) %>%
melt()
dat_1$variable <- c(rep(1, length(dat$sellingprice)), rep(2, length(dat$sellingprice)))
dat_1 %>%
ggplot(aes(x = value)) +
geom_density(fill = '#e5b9ad', color = '#e5b9ad', alpha = .5) +
geom_density(data = dat, aes(x = sellingprice), fill = 'lightgreen', color = 'skyblue', alpha = 0.4) +
labs(x = 'Значения', y = '',
title = 'Линейная модель и функции плотности') +
theme_minimal(base_family = 'Yeseva One') +
theme(plot.title = element_text(size = 14, hjust = 0.5),
plot.subtitle = element_text(size = 15),
axis.text = element_text(size = 13),
axis.title = element_text(size = 13),
axis.ticks = element_blank(),
panel.background = element_blank()) +
guides(fill = 'none') +
ease_aes('linear') +
transition_time(variable)
anim_save(filename = 'dists_get_closer_3.gif')
data %>%
ggplot(aes(x = odometer, y = sellingprice)) +
geom_point(color = '#e5b9ad', fill = 'white', shape = 21, size = 1.5) +
geom_point(color = '#e5b9ad', fill = '#e5b9ad', shape = 21, size = 1.5, alpha = 0.4)
data %>%
ggplot(aes(x = odometer, y = sellingprice)) +
geom_point(color = '#e5b9ad', fill = 'white', shape = 21, size = 1.5) +
geom_point(color = '#e5b9ad', fill = '#e5b9ad', shape = 21, size = 1.5, alpha = 0.4) +
theme_minimal(base_family = 'Yeseva One') +
labs(x = 'Пробег', y = 'Цена продажи')
data %>%
ggplot(aes(x = odometer, y = sellingprice)) +
geom_point(color = '#e5b9ad', fill = 'white', shape = 21, size = 1.5) +
geom_point(color = '#e5b9ad', fill = '#e5b9ad', shape = 21, size = 1.5, alpha = 0.4) +
theme_minimal(base_family = 'Yeseva One') +
labs(x = 'Пробег', y = 'Цена продажи') +
xlim(0, 30000)
data %>%
ggplot(aes(x = odometer, y = sellingprice)) +
geom_point(color = '#e5b9ad', fill = 'white', shape = 21, size = 1.5) +
geom_point(color = '#e5b9ad', fill = '#e5b9ad', shape = 21, size = 1.5, alpha = 0.4) +
theme_minimal(base_family = 'Yeseva One') +
labs(x = 'Пробег', y = 'Цена продажи') +
xlim(0, 300000)
library(scales)
data %>%
ggplot(aes(x = odometer, y = sellingprice)) +
geom_point(color = '#e5b9ad', fill = 'white', shape = 21, size = 1.5) +
geom_point(color = '#e5b9ad', fill = '#e5b9ad', shape = 21, size = 1.5, alpha = 0.4) +
theme_minimal(base_family = 'Yeseva One') +
labs(x = 'Пробег', y = 'Цена продажи') +
scale_x_continuous()+
xlim(0, 300000)
data %>%
ggplot(aes(x = odometer, y = sellingprice)) +
geom_point(color = '#e5b9ad', fill = 'white', shape = 21, size = 1.5) +
geom_point(color = '#e5b9ad', fill = '#e5b9ad', shape = 21, size = 1.5, alpha = 0.4) +
theme_minimal(base_family = 'Yeseva One') +
labs(x = 'Пробег', y = 'Цена продажи') +
scale_x_continuous(labels = label_number())+
xlim(0, 300000)
data %>%
ggplot(aes(x = odometer, y = sellingprice)) +
geom_point(color = '#e5b9ad', fill = 'white', shape = 21, size = 1.5) +
geom_point(color = '#e5b9ad', fill = '#e5b9ad', shape = 21, size = 1.5, alpha = 0.4) +
theme_minimal(base_family = 'Yeseva One') +
labs(x = 'Пробег', y = 'Цена продажи') +
xlim(0, 300000) +
scale_x_continuous(labels = label_number())
data %>%
ggplot(aes(x = odometer, y = sellingprice)) +
geom_point(color = '#e5b9ad', fill = 'white', shape = 21, size = 1.5) +
geom_point(color = '#e5b9ad', fill = '#e5b9ad', shape = 21, size = 1.5, alpha = 0.4) +
theme_minimal(base_family = 'Yeseva One') +
labs(x = 'Пробег', y = 'Цена продажи') +
xlim(0, 300000, labels = label_number()) #+
data %>%
ggplot(aes(x = odometer, y = sellingprice)) +
geom_point(color = '#e5b9ad', fill = 'white', shape = 21, size = 1.5) +
geom_point(color = '#e5b9ad', fill = '#e5b9ad', shape = 21, size = 1.5, alpha = 0.4) +
theme_minimal(base_family = 'Yeseva One') +
labs(x = 'Пробег', y = 'Цена продажи') +
scale_x_continuous(limits = c(0, 300000), labels = label_number())
model <- lm(data = data, price ~ odometer)
model %>%
summary()
plot(model)
summary()
model <- lm(data = data, log(price) ~ log(odometer))
model %>%
summary()
data_frame(x = log(data$odometer),
e = model$residuals)
data_frame(x = log(na.omit(data$odometer)),
e = model$residuals)
df <- data_frame(x = log(na.omit(data$odometer)),
e = model$residuals)
df %>%
ggplot(aes(x = residuals)) +
geom_density(fill = '#e5b9ad', color = '#e5b9ad', alpha = .5) +
geom_vline(xintercept = mean(residuals), color = 'grey40', alpha = 0.5, linetype = 'dash') +
labs(x = 'Значения', y = '',
title = 'распределение остатков в модели') +
theme_minimal(base_family = 'Yeseva One') +
theme(plot.title = element_text(size = 15, hjust = 0.5),
plot.subtitle = element_text(size = 15),
axis.text = element_text(size = 13),
axis.title = element_text(size = 14),
axis.ticks = element_blank(),
panel.background = element_blank()) +
guides(fill = 'none') +
plot(model)
df %>%
ggplot(aes(x = residuals)) +
geom_density(fill = '#e5b9ad', color = '#e5b9ad', alpha = .5) +
geom_vline(xintercept = mean(residuals), color = 'grey40', alpha = 0.5, linetype = 'dash') +
labs(x = 'Значения', y = '',
title = 'распределение остатков в модели') +
theme_minimal(base_family = 'Yeseva One') +
theme(plot.title = element_text(size = 15, hjust = 0.5),
plot.subtitle = element_text(size = 15),
axis.text = element_text(size = 13),
axis.title = element_text(size = 14),
axis.ticks = element_blank(),
panel.background = element_blank()) +
guides(fill = 'none')
df %>%
ggplot(aes(x = e)) +
geom_density(fill = '#e5b9ad', color = '#e5b9ad', alpha = .5) +
geom_vline(xintercept = mean(e), color = 'grey40', alpha = 0.5, linetype = 'dash') +
labs(x = 'Значения', y = '',
title = 'распределение остатков в модели') +
theme_minimal(base_family = 'Yeseva One') +
theme(plot.title = element_text(size = 15, hjust = 0.5),
plot.subtitle = element_text(size = 15),
axis.text = element_text(size = 13),
axis.title = element_text(size = 14),
axis.ticks = element_blank(),
panel.background = element_blank()) +
guides(fill = 'none')
df <- data_frame(x = log(na.omit(data$odometer)),
e = model$residuals)
df %>%
ggplot(aes(x = e)) +
geom_density(fill = '#e5b9ad', color = '#e5b9ad', alpha = .5) +
geom_vline(xintercept = mean(e), color = 'grey40', alpha = 0.5, linetype = 'dash') +
labs(x = 'Значения', y = '',
title = 'распределение остатков в модели') +
theme_minimal(base_family = 'Yeseva One') +
theme(plot.title = element_text(size = 15, hjust = 0.5),
plot.subtitle = element_text(size = 15),
axis.text = element_text(size = 13),
axis.title = element_text(size = 14),
axis.ticks = element_blank(),
panel.background = element_blank()) +
guides(fill = 'none')
View(df)
df %>%
ggplot(aes(x = e)) +
geom_density(fill = '#e5b9ad', color = '#e5b9ad', alpha = .5) +
geom_vline(xintercept = mean(e), color = 'grey40', alpha = 0.5, linetype = 'dash') +
labs(x = 'Значения', y = '',
title = 'распределение остатков в модели') +
theme_minimal(base_family = 'Yeseva One') +
theme(plot.title = element_text(size = 15, hjust = 0.5),
plot.subtitle = element_text(size = 15),
axis.text = element_text(size = 13),
axis.title = element_text(size = 14),
axis.ticks = element_blank(),
panel.background = element_blank()) +
guides(fill = 'none')
df %>%
ggplot(aes(x = e)) +
geom_density(fill = '#e5b9ad', color = '#e5b9ad', alpha = .5) +
geom_vline(xintercept = mean(df$e), color = 'grey40', alpha = 0.5, linetype = 'dash') +
labs(x = 'Значения', y = '',
title = 'распределение остатков в модели') +
theme_minimal(base_family = 'Yeseva One') +
theme(plot.title = element_text(size = 15, hjust = 0.5),
plot.subtitle = element_text(size = 15),
axis.text = element_text(size = 13),
axis.title = element_text(size = 14),
axis.ticks = element_blank(),
panel.background = element_blank()) +
guides(fill = 'none')
df %>%
ggplot(aes(x = e)) +
geom_density(fill = '#e5b9ad', color = '#e5b9ad', alpha = .5) +
geom_vline(xintercept = mean(df$e), color = 'brown', alpha = 0.5, linetype = 'dash') +
labs(x = 'Значения', y = '',
title = 'распределение остатков в модели') +
theme_minimal(base_family = 'Yeseva One') +
theme(plot.title = element_text(size = 15, hjust = 0.5),
plot.subtitle = element_text(size = 15),
axis.text = element_text(size = 13),
axis.title = element_text(size = 14),
axis.ticks = element_blank(),
panel.background = element_blank()) +
guides(fill = 'none')
df %>%
ggplot(aes(x = e)) +
geom_density(fill = '#e5b9ad', color = '#e5b9ad', alpha = .5) +
#geom_vline(xintercept = mean(df$e), color = 'brown', alpha = 0.5, linetype = 'dash') +
labs(x = 'Значения', y = '',
title = 'распределение остатков в модели') +
theme_minimal(base_family = 'Yeseva One') +
theme(plot.title = element_text(size = 15, hjust = 0.5),
plot.subtitle = element_text(size = 15),
axis.text = element_text(size = 13),
axis.title = element_text(size = 14),
axis.ticks = element_blank(),
panel.background = element_blank()) +
guides(fill = 'none')
df %>%
ggplot(aes(x = e)) +
geom_density(fill = '#e5b9ad', color = '#e5b9ad', alpha = .5) +
geom_vline(xintercept = mean(df$e), color = 'brown', alpha = 0.5, linetype = 'dashed') +
labs(x = 'Значения', y = '',
title = 'распределение остатков в модели') +
theme_minimal(base_family = 'Yeseva One') +
theme(plot.title = element_text(size = 15, hjust = 0.5),
plot.subtitle = element_text(size = 15),
axis.text = element_text(size = 13),
axis.title = element_text(size = 14),
axis.ticks = element_blank(),
panel.background = element_blank()) +
guides(fill = 'none')
df %>%
ggplot(aes(x = e)) +
geom_density(fill = '#e5b9ad', color = '#e5b9ad', alpha = .5) +
geom_vline(xintercept = mean(df$e), color = 'brown', alpha = 0.5, linetype = 'dashed') +
labs(x = 'Значения', y = '',
title = 'распределение остатков в модели') +
theme_minimal(base_family = 'Yeseva One') +
theme(plot.title = element_text(size = 15, hjust = 0.5),
plot.subtitle = element_text(size = 15),
axis.text = element_text(size = 13),
axis.title = element_text(size = 14),
axis.ticks = element_blank(),
panel.background = element_blank()) +
scale_x_continuous(limits = c(-3,2)) +
guides(fill = 'none')
cor(df$e, df$x)
df %>%
ggplot(aes(x = e^2)) +
geom_density(fill = '#e5b9ad', color = '#e5b9ad', alpha = .5) +
geom_vline(xintercept = mean(df$e^2), color = 'brown', alpha = 0.5, linetype = 'dashed') +
labs(x = 'Значения', y = '',
title = 'распределение остатков в модели') +
theme_minimal(base_family = 'Yeseva One') +
theme(plot.title = element_text(size = 15, hjust = 0.5),
plot.subtitle = element_text(size = 15),
axis.text = element_text(size = 13),
axis.title = element_text(size = 14),
axis.ticks = element_blank(),
panel.background = element_blank()) +
scale_x_continuous(limits = c(-3,2)) +
guides(fill = 'none')
cor(df$e^2, df$x)
