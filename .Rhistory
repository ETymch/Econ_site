summarise(Ваш.возраст., count_na = is.na(freq)) %>%
group_by(Ваш.возраст., count_na) %>%
summarize(count = n())
}
get_participation_1(69)
get_participation_1(69)
colnames(res)
sum <- get_sum(86)
date <- get_date_1(87)
mean_sum_freq_1(sum, date, boot)
get_participation_1(87)
res[,86]
colnames(res)[86]
mean_sum_freq_1 <- function(sum, freq, boot){
m <- get_sum_distribution(sum, boot) %>%
na.omit() %>%
c() %>%
setdiff('Ошибка!') %>%
as.numeric()
dist_m <- fitdist(m, 'weibull')
f <- get_freq_distribution_1(freq, boot) %>%
na.omit() %>%
c() %>%
setdiff('Ошибка!') %>%
as.numeric()
dist_f <- fitdist(f, 'weibull')
mean_sum <- rweibull(shape = dist_m$estimate[1], scale = dist_m$estimate[2] * 0.659, n = 10000) %>%
mean()
mean_freq <- rweibull(shape = dist_f$estimate[1], scale = dist_f$estimate[2] * 0.659 * 0.75, n = 10000) %>%
mean()
c(mean_sum, mean_freq)
}
sum <- get_sum(86)
date <- get_date_1(87)
mean_sum_freq_1(sum, date, boot)
colnames(res)[87]
colnames(res)[87]
colnames(res)[86]
sum <- get_sum(86)
unique(sum)
colnames(res)
colnames(res)
sum <- get_sum(107)
date <- get_date_1(108)
mean_sum_freq_1(sum, date, boot)
get_participation_1(108)
colnames(res)
sum <- get_sum(127)
date <- get_date_1(128)
mean_sum_freq_1(sum, date, boot)
get_participation_1(128)
colnames(res)
sum <- get_sum(147)
date <- get_date_1(148)
mean_sum_freq_1(sum, date, boot)
get_participation_1(148)
colnames(res)
colnames(res)
sum <- get_sum(161)
date <- get_date_1(162)
mean_sum_freq_1(sum, date, boot)
get_participation_1(148)
get_participation_1(162)
colnames(res)
sum <- get_sum(176)
date <- get_date_1(177)
mean_sum_freq_1(sum, date, boot)
get_participation_1(162)
get_participation_1(177)
colnames(res)
res <- read.csv('Стоимость интернет-покупок непродовольственных товаров.csv')
sum <- get_sum(38)
date <- get_date(41)
get_participation(46)
sum <- get_sum(38)
date <- get_date(41)
get_participation(46)
date <- res %>%
select(respondent_id, colnames(res)[41]) %>%
rename('Date' = colnames(res)[41]) %>%
filter(Date != 'Response',
Date != 'Другое (укажите)') %>%
select(Date)
date <- res %>%
select(respondent_id, colnames(res)[41]) %>%
rename('Date' = colnames(res)[41]) %>%
filter(Date != 'Response',
Date != 'Другое (укажите)') %>%
select(Date)
date <- res %>%
dplyr::select(respondent_id, colnames(res)[41]) %>%
rename('Date' = colnames(res)[41]) %>%
filter(Date != 'Response',
Date != 'Другое (укажите)') %>%
select(Date)
date <- res %>%
dplyr::select(respondent_id, colnames(res)[41]) %>%
rename('Date' = colnames(res)[41]) %>%
filter(Date != 'Response',
Date != 'Другое (укажите)') %>%
dplyr::select(Date)
get_participation(46)
mean_sum_freq(sum, date, boot) # Средний чек и частота
get_participation(46)
date <- get_date(41)
get_participation(41)
source("functions.R")
res %>%
select(respondent_id, X.1:X.11) %>%
melt(id.vars = 'respondent_id') %>%
mutate(variable = substr(variable, 3, 10) %>% as.numeric()) %>%
group_by(value) %>%
summarize(count = n()) %>%
filter(value != '') %>%
ggplot(aes(y = value, x = count)) +
geom_bin_2d(color = hse_blue, fill = hse_blue, alpha = 0.8) +
theme_ipsum(base_family = 'HSESans', base_size = 10) +
theme(legend.position = 'none') +
labs(x = 'Число упоминаний',
y = '',
title = 'Товары какой группы вы чаще заказываете онлайн?')
res <- read.csv('Стоимость интернет-покупок непродовольственных товаров.csv')
res %>%
select(respondent_id, X.1:X.11) %>%
melt(id.vars = 'respondent_id') %>%
mutate(variable = substr(variable, 3, 10) %>% as.numeric()) %>%
group_by(value) %>%
summarize(count = n()) %>%
filter(value != '') %>%
ggplot(aes(y = value, x = count)) +
geom_bin_2d(color = hse_blue, fill = hse_blue, alpha = 0.8) +
theme_ipsum(base_family = 'HSESans', base_size = 10) +
theme(legend.position = 'none') +
labs(x = 'Число упоминаний',
y = '',
title = 'Товары какой группы вы чаще заказываете онлайн?')
res %>%
dplyr::select(respondent_id, X.1:X.11) %>%
melt(id.vars = 'respondent_id') %>%
mutate(variable = substr(variable, 3, 10) %>% as.numeric()) %>%
group_by(value) %>%
summarize(count = n()) %>%
filter(value != '') %>%
ggplot(aes(y = value, x = count)) +
geom_bin_2d(color = hse_blue, fill = hse_blue, alpha = 0.8) +
theme_ipsum(base_family = 'HSESans', base_size = 10) +
theme(legend.position = 'none') +
labs(x = 'Число упоминаний',
y = '',
title = 'Товары какой группы вы чаще заказываете онлайн?')
res %>%
dplyr::select(respondent_id, X.1:X.11) %>%
melt(id.vars = 'respondent_id') %>%
mutate(variable = substr(variable, 3, 10) %>% as.numeric()) %>%
group_by(value) %>%
summarize(count = n()) %>%
filter(value != '') %>%
ggplot(aes(y = value, x = count)) +
geom_segment()+
#geom_bin_2d(color = hse_blue, fill = hse_blue, alpha = 0.8) +
theme_ipsum(base_family = 'HSESans', base_size = 10) +
theme(legend.position = 'none') +
labs(x = 'Число упоминаний',
y = '',
title = 'Товары какой группы вы чаще заказываете онлайн?')
res %>%
dplyr::select(respondent_id, X.1:X.11) %>%
melt(id.vars = 'respondent_id') %>%
mutate(variable = substr(variable, 3, 10) %>% as.numeric()) %>%
group_by(value) %>%
summarize(count = n()) %>%
filter(value != '') %>%
ggplot(aes(y = value, x = count)) +
geom_segment(x = count, yend = value)+
#geom_bin_2d(color = hse_blue, fill = hse_blue, alpha = 0.8) +
theme_ipsum(base_family = 'HSESans', base_size = 10) +
theme(legend.position = 'none') +
labs(x = 'Число упоминаний',
y = '',
title = 'Товары какой группы вы чаще заказываете онлайн?')
res %>%
dplyr::select(respondent_id, X.1:X.11) %>%
melt(id.vars = 'respondent_id') %>%
mutate(variable = substr(variable, 3, 10) %>% as.numeric()) %>%
group_by(value) %>%
summarize(count = n()) %>%
filter(value != '') %>%
ggplot(aes(y = value, x = count)) +
geom_segment(aes(x = count, yend = value))+
#geom_bin_2d(color = hse_blue, fill = hse_blue, alpha = 0.8) +
theme_ipsum(base_family = 'HSESans', base_size = 10) +
theme(legend.position = 'none') +
labs(x = 'Число упоминаний',
y = '',
title = 'Товары какой группы вы чаще заказываете онлайн?')
res %>%
dplyr::select(respondent_id, X.1:X.11) %>%
melt(id.vars = 'respondent_id') %>%
mutate(variable = substr(variable, 3, 10) %>% as.numeric()) %>%
group_by(value) %>%
summarize(count = n()) %>%
filter(value != '') %>%
ggplot(aes(y = value, x = count)) +
geom_segment(aes(xend = count, yend = value))+
#geom_bin_2d(color = hse_blue, fill = hse_blue, alpha = 0.8) +
theme_ipsum(base_family = 'HSESans', base_size = 10) +
theme(legend.position = 'none') +
labs(x = 'Число упоминаний',
y = '',
title = 'Товары какой группы вы чаще заказываете онлайн?')
res %>%
dplyr::select(respondent_id, X.1:X.11) %>%
melt(id.vars = 'respondent_id') %>%
mutate(variable = substr(variable, 3, 10) %>% as.numeric()) %>%
group_by(value) %>%
summarize(count = n()) %>%
filter(value != '')
res %>%
dplyr::select(respondent_id, X.1:X.11) %>%
melt(id.vars = 'respondent_id') %>%
mutate(variable = substr(variable, 3, 10) %>% as.numeric()) %>%
group_by(value) %>%
summarize(count = n()) %>%
filter(value != '') %>%
ggplot(aes(y = value, x = count)) +
geom_segment(aes(x = count, yend = value))+
#geom_bin_2d(color = hse_blue, fill = hse_blue, alpha = 0.8) +
theme_ipsum(base_family = 'HSESans', base_size = 10) +
theme(legend.position = 'none') +
labs(x = 'Число упоминаний',
y = '',
title = 'Товары какой группы вы чаще заказываете онлайн?')
res %>%
dplyr::select(respondent_id, X.1:X.11) %>%
melt(id.vars = 'respondent_id') %>%
mutate(variable = substr(variable, 3, 10) %>% as.numeric()) %>%
group_by(value) %>%
summarize(count = n()) %>%
filter(value != '') %>%
ggplot(aes(y = value, x = count)) +
geom_segment(aes(x = value, yend = count))+
#geom_bin_2d(color = hse_blue, fill = hse_blue, alpha = 0.8) +
theme_ipsum(base_family = 'HSESans', base_size = 10) +
theme(legend.position = 'none') +
labs(x = 'Число упоминаний',
y = '',
title = 'Товары какой группы вы чаще заказываете онлайн?')
res %>%
dplyr::select(respondent_id, X.1:X.11) %>%
melt(id.vars = 'respondent_id') %>%
mutate(variable = substr(variable, 3, 10) %>% as.numeric()) %>%
group_by(value) %>%
summarize(count = n()) %>%
filter(value != '') %>%
ggplot(aes(y = value, x = count)) +
geom_segment(aes(xend = value, yend = count))+
#geom_bin_2d(color = hse_blue, fill = hse_blue, alpha = 0.8) +
theme_ipsum(base_family = 'HSESans', base_size = 10) +
theme(legend.position = 'none') +
labs(x = 'Число упоминаний',
y = '',
title = 'Товары какой группы вы чаще заказываете онлайн?')
res %>%
dplyr::select(respondent_id, X.1:X.11) %>%
melt(id.vars = 'respondent_id') %>%
mutate(variable = substr(variable, 3, 10) %>% as.numeric()) %>%
group_by(value) %>%
summarize(count = n()) %>%
filter(value != '') %>%
ggplot(aes(y = value, x = count)) +
geom_segment(aes(xend = value, yend = 0))+
#geom_bin_2d(color = hse_blue, fill = hse_blue, alpha = 0.8) +
theme_ipsum(base_family = 'HSESans', base_size = 10) +
theme(legend.position = 'none') +
labs(x = 'Число упоминаний',
y = '',
title = 'Товары какой группы вы чаще заказываете онлайн?')
res %>%
dplyr::select(respondent_id, X.1:X.11) %>%
melt(id.vars = 'respondent_id') %>%
mutate(variable = substr(variable, 3, 10) %>% as.numeric()) %>%
group_by(value) %>%
summarize(count = n()) %>%
filter(value != '') %>%
ggplot(aes(y = value, x = count)) +
geom_segment(aes(xend = count, yend = 0))+
#geom_bin_2d(color = hse_blue, fill = hse_blue, alpha = 0.8) +
theme_ipsum(base_family = 'HSESans', base_size = 10) +
theme(legend.position = 'none') +
labs(x = 'Число упоминаний',
y = '',
title = 'Товары какой группы вы чаще заказываете онлайн?')
res %>%
dplyr::select(respondent_id, X.1:X.11) %>%
melt(id.vars = 'respondent_id') %>%
mutate(variable = substr(variable, 3, 10) %>% as.numeric()) %>%
group_by(value) %>%
summarize(count = n()) %>%
filter(value != '') %>%
ggplot(aes(y = value, x = count)) +
geom_segment(aes(x = count, yend = 0))+
#geom_bin_2d(color = hse_blue, fill = hse_blue, alpha = 0.8) +
theme_ipsum(base_family = 'HSESans', base_size = 10) +
theme(legend.position = 'none') +
labs(x = 'Число упоминаний',
y = '',
title = 'Товары какой группы вы чаще заказываете онлайн?')
res %>%
dplyr::select(respondent_id, X.1:X.11) %>%
melt(id.vars = 'respondent_id') %>%
mutate(variable = substr(variable, 3, 10) %>% as.numeric()) %>%
group_by(value) %>%
summarize(count = n()) %>%
filter(value != '') %>%
ggplot(aes(y = value, x = count)) +
geom_segment(aes(x = value, yend = 0))+
#geom_bin_2d(color = hse_blue, fill = hse_blue, alpha = 0.8) +
theme_ipsum(base_family = 'HSESans', base_size = 10) +
theme(legend.position = 'none') +
labs(x = 'Число упоминаний',
y = '',
title = 'Товары какой группы вы чаще заказываете онлайн?')
res %>%
dplyr::select(respondent_id, X.1:X.11) %>%
melt(id.vars = 'respondent_id') %>%
mutate(variable = substr(variable, 3, 10) %>% as.numeric()) %>%
group_by(value) %>%
summarize(count = n()) %>%
filter(value != '') %>%
ggplot(aes(y = count, x = value)) +
geom_segment(aes(x = value, yend = 0))+
#geom_bin_2d(color = hse_blue, fill = hse_blue, alpha = 0.8) +
theme_ipsum(base_family = 'HSESans', base_size = 10) +
theme(legend.position = 'none') +
labs(x = 'Число упоминаний',
y = '',
title = 'Товары какой группы вы чаще заказываете онлайн?')
res %>%
dplyr::select(respondent_id, X.1:X.11) %>%
melt(id.vars = 'respondent_id') %>%
mutate(variable = substr(variable, 3, 10) %>% as.numeric()) %>%
group_by(value) %>%
summarize(count = n()) %>%
filter(value != '') %>%
ggplot(aes(y = count, x = value)) +
geom_segment(aes(xend = value, yend = 0))+
#geom_bin_2d(color = hse_blue, fill = hse_blue, alpha = 0.8) +
theme_ipsum(base_family = 'HSESans', base_size = 10) +
theme(legend.position = 'none') +
labs(x = 'Число упоминаний',
y = '',
title = 'Товары какой группы вы чаще заказываете онлайн?')
res %>%
dplyr::select(respondent_id, X.1:X.11) %>%
melt(id.vars = 'respondent_id') %>%
mutate(variable = substr(variable, 3, 10) %>% as.numeric()) %>%
group_by(value) %>%
summarize(count = n()) %>%
filter(value != '') %>%
ggplot(aes(y = count, x = value)) +
geom_segment(aes(xend = value, yend = 0))+
coord_flip() +
#geom_bin_2d(color = hse_blue, fill = hse_blue, alpha = 0.8) +
theme_ipsum(base_family = 'HSESans', base_size = 10) +
theme(legend.position = 'none') +
labs(x = 'Число упоминаний',
y = '',
title = 'Товары какой группы вы чаще заказываете онлайн?')
res %>%
dplyr::select(respondent_id, X.1:X.11) %>%
melt(id.vars = 'respondent_id') %>%
mutate(variable = substr(variable, 3, 10) %>% as.numeric()) %>%
group_by(value) %>%
summarize(count = n()) %>%
filter(value != '') %>%
ggplot(aes(y = count, x = value)) +
geom_segment(aes(xend = value, yend = 0), size = 2)+
coord_flip() +
#geom_bin_2d(color = hse_blue, fill = hse_blue, alpha = 0.8) +
theme_ipsum(base_family = 'HSESans', base_size = 10) +
theme(legend.position = 'none') +
labs(x = 'Число упоминаний',
y = '',
title = 'Товары какой группы вы чаще заказываете онлайн?')
res %>%
dplyr::select(respondent_id, X.1:X.11) %>%
melt(id.vars = 'respondent_id') %>%
mutate(variable = substr(variable, 3, 10) %>% as.numeric()) %>%
group_by(value) %>%
summarize(count = n()) %>%
filter(value != '') %>%
ggplot(aes(y = count, x = value)) +
geom_segment(aes(xend = value, yend = 0), size = 2, color = 'hse_blue', alpha = 0.5)+
coord_flip() +
#geom_bin_2d(color = hse_blue, fill = hse_blue, alpha = 0.8) +
theme_ipsum(base_family = 'HSESans', base_size = 10) +
theme(legend.position = 'none') +
labs(x = 'Число упоминаний',
y = '',
title = 'Товары какой группы вы чаще заказываете онлайн?')
hse_blue <- '#102D69'
res %>%
dplyr::select(respondent_id, X.1:X.11) %>%
melt(id.vars = 'respondent_id') %>%
mutate(variable = substr(variable, 3, 10) %>% as.numeric()) %>%
group_by(value) %>%
summarize(count = n()) %>%
filter(value != '') %>%
ggplot(aes(y = count, x = value)) +
geom_segment(aes(xend = value, yend = 0), size = 2, color = hse_blue, alpha = 0.5)+
coord_flip() +
#geom_bin_2d(color = hse_blue, fill = hse_blue, alpha = 0.8) +
theme_ipsum(base_family = 'HSESans', base_size = 10) +
theme(legend.position = 'none') +
labs(x = 'Число упоминаний',
y = '',
title = 'Товары какой группы вы чаще заказываете онлайн?')
res %>%
dplyr::select(respondent_id, X.1:X.11) %>%
melt(id.vars = 'respondent_id') %>%
mutate(variable = substr(variable, 3, 10) %>% as.numeric()) %>%
group_by(value) %>%
summarize(count = n()) %>%
filter(value != '') %>%
ggplot(aes(y = count, x = value)) +
geom_segment(aes(xend = value, yend = 0), size = 2, color = hse_blue, alpha = 0.7)+
coord_flip() +
#geom_bin_2d(color = hse_blue, fill = hse_blue, alpha = 0.8) +
theme_ipsum(base_family = 'HSESans', base_size = 10) +
theme(legend.position = 'none') +
labs(x = 'Число упоминаний',
y = '',
title = 'Товары какой группы вы чаще заказываете онлайн?')
res %>%
dplyr::select(respondent_id, X.1:X.11) %>%
melt(id.vars = 'respondent_id') %>%
mutate(variable = substr(variable, 3, 10) %>% as.numeric()) %>%
group_by(value) %>%
summarize(count = n()) %>%
filter(value != '') %>%
ggplot(aes(y = count, x = value)) +
geom_segment(aes(xend = value, yend = 0), size = 2, color = hse_blue, alpha = 0.7)+
geom_point(size = 3, color = hse_blue, alpha = 0.9)
res %>%
dplyr::select(respondent_id, X.1:X.11) %>%
melt(id.vars = 'respondent_id') %>%
mutate(variable = substr(variable, 3, 10) %>% as.numeric()) %>%
group_by(value) %>%
summarize(count = n()) %>%
filter(value != '') %>%
ggplot(aes(y = count, x = value)) +
geom_segment(aes(xend = value, yend = 0), size = 2, color = hse_blue, alpha = 0.7)+
geom_point(size = 3, color = hse_blue, alpha = 0.9) +
coord_flip() +
#geom_bin_2d(color = hse_blue, fill = hse_blue, alpha = 0.8) +
theme_ipsum(base_family = 'HSESans', base_size = 10) +
theme(legend.position = 'none') +
labs(x = 'Число упоминаний',
y = '',
title = 'Товары какой группы вы чаще заказываете онлайн?')
res %>%
dplyr::select(respondent_id, X.1:X.11) %>%
melt(id.vars = 'respondent_id') %>%
mutate(variable = substr(variable, 3, 10) %>% as.numeric()) %>%
group_by(value) %>%
summarize(count = n()) %>%
filter(value != '') %>%
ggplot(aes(y = count, x = value)) +
geom_segment(aes(xend = value, yend = 0), size = 2, color = hse_blue, alpha = 0.7)+
geom_point(size = 3, color = hse_blue, alpha = 0.9) +
coord_flip() +
#geom_bin_2d(color = hse_blue, fill = hse_blue, alpha = 0.8) +
theme_ipsum(base_family = 'HSESans', base_size = 10) +
theme(legend.position = 'none') +
labs(x = '',
y = 'Число упоминаний',
title = 'Товары какой группы вы чаще заказываете онлайн?')
res %>%
dplyr::select(respondent_id, X.1:X.11) %>%
melt(id.vars = 'respondent_id') %>%
mutate(variable = substr(variable, 3, 10) %>% as.numeric()) %>%
group_by(value) %>%
summarize(count = n()) %>%
filter(value != '') %>%
ggplot(aes(y = count, x = value)) +
geom_segment(aes(xend = value, yend = 0), size = 2, color = hse_blue, alpha = 0.7)+
geom_point(size = 3, color = hse_blue, alpha = 0.9) +
coord_flip() +
theme_ipsum(base_family = 'HSESans', base_size = 10) +
theme(legend.position = 'none',
plot.title = element_text(hjust = 1)) +
labs(x = '',
y = 'Число упоминаний',
title = 'Товары какой группы вы чаще заказываете онлайн?')
ggsave('Groups.svg')
library(tidyverse)
library(showtext)
library(sysfonts)
library(rcartocolor)
library(reshape2)
library(stargazer)
library(patchwork)
font_add(family = 'HSESans', regular = "C:\\Users\\evgen\\Downloads\\HSESans-Bold.otf")
showtext_auto()
data <- read.csv('https://raw.githubusercontent.com/ETymch/Econometrics_2023/main/Datasets/econ_macro_data.csv') %>%
select(-X) %>%
mutate(Date = as.Date(Date))
data <- read.csv('https://raw.githubusercontent.com/ETymch/Econometrics_2023/main/Datasets/econ_macro_data.csv')
View(data)
data <- read.csv('https://raw.githubusercontent.com/ETymch/Econometrics_2023/main/Datasets/econ_macro_data.csv') %>%
select(-X) %>%
mutate(Date = as.Date(Date))
