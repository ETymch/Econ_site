geom_density(alpha = 0.5) +
theme_ipsum() +
xlim(0, 0.06)
View(data_1)
data_1 <- data %>%
#filter(alc_sh > 0) %>%
mutate(l_alc_sh = log(alc_sh))
data_1 %>%
ggplot(aes(x = l_alc_sh, color = Tip.naselennogo.punkta, fill = Tip.naselennogo.punkta)) +
geom_density(alpha = 0.5) +
theme_ipsum() +
xlim(0, 0.06)
data_1 %>%
ggplot(aes(x = l_alc_sh, color = Tip.naselennogo.punkta, fill = Tip.naselennogo.punkta)) +
geom_density(alpha = 0.5) +
theme_ipsum()
data_1 <- data_1 %>%
filter(l_alc_sh > -Inf)
as_gorod <- data_1 %>%
filter(Tip.naselennogo.punkta == 'городской')
as_gorod <- as_gorod$alc_sh %>%
mean()
as_selo <- data_1 %>%
filter(Tip.naselennogo.punkta == 'сельский')
as_selo <- as_selo$alc_sh %>%
mean()
as_gorod <= as_selo
as_gorod - as_selo
rpt_1 <- rpt(5000, data_1$alc_sh, 10000)
data.frame(rpt_1) %>%
ggplot(aes(x = rpt_1)) +
geom_density()
data.frame(rpt_1) %>%
ggplot(aes(x = abs(rpt_1))) +
geom_density()
data$alc_sh %>%
log() %>%
density %>%
plot()
data_1 <- data %>%
#filter(sberezheniya > 0) %>%
mutate(l_sber = log(sberezheniya),
l_alc_sh = log(alc_sh)) %>%
filter(l_sber > 0)
data <-
data %>%
mutate(sberezheniya = Denezhnyy.dokhod - Raskhod.na.konechnoye.potrebleniye,
Tip.naselennogo.punkta = as.factor(Tip.naselennogo.punkta),
alc_sh = Raskhody.na.pokupku.alkogol.U.02B9.nykh.napitkov / Denezhnyy.dokhod)
data_1 <- data %>%
#filter(sberezheniya > 0) %>%
mutate(l_sber = log(sberezheniya),
l_alc_sh = log(alc_sh)) %>%
filter(l_sber > 0)
View(data_1)
data$alc_sh %>%
#log() %>%
density %>%
plot()
which(data$alc_sh >= 1)
data[-which(data$alc_sh >= 1), ]$alc_sh
data[-which(data$alc_sh >= 1), ]$alc_sh %>%
density %>%
plot()
data <-
data %>%
mutate(alc_ind = ifelse(data$alc_sh == 0, 0, 1))
lm(sberezheniya ~ alc_ind, data)
lm(sberezheniya ~ alc_ind, data) %>%
summary()
data <-
data %>%
mutate(alc_ind = ifelse(data$alc_sh == 0, 0, 1),
sber_sh = sberezheniya / Denezhnyy.dokhod)
lm(sber_sh ~ alc_ind, data)
lm(sberezheniya ~ alc_ind, data[-which(data$alc_sh >= 1), ]) %>%
summary()
lm(sber_sh ~ alc_ind, data[-which(data$alc_sh >= 1), ])
mod_0 <- lm(sber_sh ~ alc_ind, data[-which(data$alc_sh >= 1), ])
hatvalues(mod_0)
hatvalues(mod_0) %>% plot()
hatvalues(mod_0) %>%
density %>%
plot()
mod_0 <- lm(sber_sh ~ alc_sh, data[-which(data$alc_sh >= 1), ])
hatvalues(mod_0) %>%
density %>%
plot()
mod_0 %>% summary
library(wooldridge)
library(tidyverse)
wooldridge::wine
?wooldridge::wine
wooldridge::wageprc
?wooldridge::wageprc
?wooldridge::wagepan
wooldridge::voucher
?wooldridge::voucher
?wooldridge::voucher
wooldridge::volat
wooldridge::smoke
?wooldridge::smoke
?wooldridge::slp75_81
?wooldridge::saving
?wooldridge::rental
rental
?wooldridge::recid
wooldridge::recid
wooldridge::rdtelec
wooldridge::prminwge
wooldridge::prison
?wooldridge::prison
?wooldridge::pension
?wooldridge::openness
wooldridge::openness
?wooldridge::okun
?wooldridge::murder
?wooldridge::minwage
?wooldridge::meapsingle
?wooldridge::loanapp
loanapp
dta <- loanapp
View(dta)
?wooldridge::labsup
?wooldridge::jtrain2
?wooldridge::injury
?wooldridge::htv
?wooldridge::happiness
?wooldridge::fish
?wooldridge::fair
?wooldridge::ezanders
?wooldridge::expendshares
?wooldridge::driving
driving
dta <- driving
View(dta)
dta <- driving
mod <- lm(totfatpvm ~ bac08 + zerotol + minage + seatbelt + unem + sbprim + slnone + sl75 + sl70 + sl65)
mod <- lm(totfatpvm ~ bac08 + zerotol + minage + seatbelt + unem + sbprim + slnone + sl75 + sl70 + sl65, data = dta)
library(stargazer)
stargazer(mod, type = 'text')
mod <- lm(totfatpvm ~ bac08 + zerotol + minage + seatbelt + unem + sbprim + slnone + sl75 + sl70, data = dta)
library(stargazer)
stargazer(mod, type = 'text')
mod <- lm(totfatpvm ~ bac10 + zerotol + minage + seatbelt + unem + sbprim + slnone + sl75 + sl70, data = dta)
stargazer(mod, type = 'text')
mod <- lm(totfatpvm ~ bac8 + zerotol + minage + seatbelt + unem + sbprim + slnone + sl75 + sl70, data = dta)
mod <- lm(totfatpvm ~ bac08 + zerotol + minage + seatbelt + unem + sbprim + slnone + sl75 + sl70, data = dta)
stargazer(mod, type = 'text')
mod1 <- lm(totfatpvm ~ bac08 + bac10 + minage + seatbelt + unem + sbprim + slnone + sl75 + sl70, data = dta)
stargazer(mod,mod1, type = 'text')
sample <- c("W", "L", "W", "W", "W", "L", "W", "L", "W")
W <- sum(sample == 'W')
W
L <- sum(sample == 'L')
ways <- sapply(p, function(q) (q * 4)^W * ((1-q)*4)^L )
p <- c(0, 0.25, 0.5, 0.75, 1) # proportions of water
ways <- sapply(p, function(q) (q * 4)^W * ((1-q)*4)^L )
prob <- ways / sum(ways)
cbind(p, ways, prob)
(p[1]*4)^W
(p[2]*4)^W
(p[2]*4)^W * (1 - p[2])*4 ^ L
ways
(p[2]*4)^W * ((1 - p[2])*4) ^ L
sim_globe <- function(p = 0.7, N = 9){
sample(c('W', 'L'), size = N, prob = c(p, 1-p), replace = T)
}
sim_globe(0.6, 10)
sim_globe(0.6, 10)
sim_globe(0.9, 10)
rreplicate(sim_globe(p = 0.5, N = 9), n = 10)
replicate(sim_globe(p = 0.5, N = 9), n = 10)
replicate(sim_globe(p = 0.5, N = 9), n = 10)
compute_posterior <- function(samp, poss = c(0, 0.25, 0.5, 0.75, 1)){
W = sum(samp == 'W')
L = sum(samp == 'L')
ways <- sapply(poss, function(q) (q * 4)^W * ((1-q)*4)^L)
post <- ways / sum(ways)
bars <- sapply(post, function(q) make_bar(q) )
tibble(poss, ways, post = round(post, 3), bars)
}
compute_posterior(sim_globe(p = 0.5, N = 9))
install.packages("animint2")
library(animint2)
compute_posterior <- function(samp, poss = c(0, 0.25, 0.5, 0.75, 1)){
W = sum(samp == 'W')
L = sum(samp == 'L')
ways <- sapply(poss, function(q) (q * 4)^W * ((1-q)*4)^L)
post <- ways / sum(ways)
bars <- sapply(post, function(q) make_bar(q) )
tibble(poss, ways, post = round(post, 3), bars)
}
compute_posterior(sim_globe(p = 0.5, N = 9))
?animint::make_bar
?animint2::make_bar
prob <- ways / sum(ways)
cbind(p, ways, prob)
compute_posterior <- function(samp, poss = c(0, 0.25, 0.5, 0.75, 1)){
W = sum(samp == 'W')
L = sum(samp == 'L')
ways <- sapply(poss, function(q) (q * 4)^W * ((1-q)*4)^L)
post <- ways / sum(ways))
compute_posterior <- function(samp, poss = c(0, 0.25, 0.5, 0.75, 1)){
W = sum(samp == 'W')
L = sum(samp == 'L')
ways <- sapply(poss, function(q) (q * 4)^W * ((1-q)*4)^L)
post <- ways / sum(ways)
post <- tibble(poss, ways, post)
bars <- sapply(post, function(q) make_bar(q) )
tibble(poss, ways, post = round(post, 3), bars)
}
compute_posterior(sim_globe(p = 0.5, N = 9))
compute_posterior <- function(samp, poss = c(0, 0.25, 0.5, 0.75, 1)){
W = sum(samp == 'W')
L = sum(samp == 'L')
ways <- sapply(poss, function(q) (q * 4)^W * ((1-q)*4)^L)
post <- ways / sum(ways)
post <- tibble(poss, ways, post)
bars <- sapply(post, function(q) make_bar(q, post) )
tibble(poss, ways, post = round(post, 3), bars)
}
compute_posterior(sim_globe(p = 0.5, N = 9))
cbind(p, ways, prob)
compute_posterior <- function(samp, poss = c(0, 0.25, 0.5, 0.75, 1)){
W = sum(samp == 'W')
L = sum(samp == 'L')
ways <- sapply(poss, function(q) (q * 4)^W * ((1-q)*4)^L)
post <- ways / sum(ways)
post <- cbind(poss, ways, post)
bars <- sapply(post, function(q) make_bar(q, post) )
tibble(poss, ways, post = round(post, 3), bars)
}
compute_posterior(sim_globe(p = 0.5, N = 9))
compute_posterior <- function(samp, poss = c(0, 0.25, 0.5, 0.75, 1)){
W = sum(samp == 'W')
L = sum(samp == 'L')
ways <- sapply(poss, function(q) (q * 4)^W * ((1-q)*4)^L)
post <- ways / sum(ways)
post <- cbind(poss, ways, post)
bars <- sapply(post, function(q) make_bar(q, 'post') )
tibble(poss, ways, post = round(post, 3), bars)
}
compute_posterior(sim_globe(p = 0.5, N = 9))
compute_posterior <- function(samp, poss = c(0, 0.25, 0.5, 0.75, 1)){
W = sum(samp == 'W')
L = sum(samp == 'L')
ways <- sapply(poss, function(q) (q * 4)^W * ((1-q)*4)^L)
post <- ways / sum(ways)
post <- cbind(poss, ways, post)
bars <- sapply(post, function(q) make_bar(q, x.name = 'post') )
tibble(poss, ways, post = round(post, 3), bars)
}
compute_posterior(sim_globe(p = 0.5, N = 9))
x = cbind(p, ways, prob)
compute_posterior <- function(samp, poss = c(0, 0.25, 0.5, 0.75, 1)){
W = sum(samp == 'W')
L = sum(samp == 'L')
ways <- sapply(poss, function(q) (q * 4)^W * ((1-q)*4)^L)
post <- ways / sum(ways)
post <- cbind(poss, ways, post) %>% tibble()
bars <- sapply(post, function(q) make_bar(q, x.name = 'post') )
tibble(poss, ways, post = round(post, 3), bars)
}
compute_posterior(sim_globe(p = 0.5, N = 9))
?rbeta
1e3
rbeta(1000, 7, 4)
post_samples <- rbeta(1000, 7, 4)
devtools::install_github("rmcelreath/rethinking")
density(post_samples)
density(post_samples) %>% plot()
dbeta(x, 7, 4)
dbeta(7, 4)
lines(dbeta(1000, 7, 4))
lines(density(dbeta(1000, 7, 4)))
density(dbeta(1000, 7, 4))
dbeta(1000, 7, 4)
dbeta(x, 7, 4)
dbeta(1, 7, 4)
dbeta(1000, 7, 4)
post_samples <- rbeta(1000, 7, 4)
pred_post <- sapply(post_samplesm function(p) sum(sim_globe(p, 10) == 'W'))
pred_post <- sapply(post_samples, function(p) sum(sim_globe(p, 10) == 'W'))
tab_post <- table(pred_post)
for (i in 1:10) lines(c(i,i), c(0, tab_post[i + 1]), lwd = 4, col = 4)
for (i in 1:10) lines(c(i,i), c(0, tab_post[i + 1]), lwd = 4, col = 4)
post_samples <- rbeta(1000, 7, 4)
pred_post <- sapply(post_samples, function(p) sum(sim_globe(p, 10) == 'W'))
tab_post <- table(pred_post)
for (i in 1:10) lines(c(i,i), c(0, tab_post[i + 1]), lwd = 4, col = 4)
plot.new()
for (i in 1:10) lines(c(i,i), c(0, tab_post[i + 1]), lwd = 4, col = 4)
pred_post
pred_post
plot.new()
for (i in 0:10) lines(c(i,i), c(0, tab_post[i + 1]), lwd = 4, col = 4)
pred_post %>% density %>% plot()
pred_post %>% mean()
library(wooldridge)
library(tidyverse)
dta <- driving # Датасет
?driving # Информация о данных, описание переменных в табличке.
mod_gaussian <- glm(totfatpvm ~ zerotol + unem, family = gaussian)
mod_gaussian <- glm(totfatpvm ~ zerotol + unem, family = gaussian, data = dta)
mod_gaussian
lm(totfatpvm ~ zerotol + unem, data = dta)
mod_pooisson <- glm(totfatpvm ~ zerotol + unem, family = poisson, data = dta)
library(stargazer)
stargazer(mod_gaussian, mod_pooisson)
stargazer(mod_gaussian, mod_pooisson, type = 'text')
density(dta$totfatpvm)
density(dta$totfatpvm) %>% plot()
mod_poi_1 <- glm(log(totfatpvm) ~ zerotol + unem, family = gaussian, data = dta)
stargazer(mod_gaussian, mod_pooisson, mod_poi_1, type = 'text')
mod_pooisson <- glm(totfatpvm ~ zerotol + unem, family = poisson, data = dta)
mod_pooisson <- glm(totfatpvm ~ zerotol + unem, family = poisson, data = dta)
stargazer(mod_gaussian, mod_pooisson, mod_poi_1, type = 'text')
residuals(mod_poi_1) %>% density %>% plot()
residuals(mod_pooisson) %>% density %>% plot()
?wooldridge::murder
murder$mrdrte %>% density %>% plot
murder %>%
filter(mrdrte <= 30) %>%
ggplot(aes(x = mrdrte)) +
geom_density()
murder %>%
filter(mrdrte <= 30) %>%
ggplot(aes(x = log(mrdrte))) +
geom_density()
?wooldridge::voucher
?loanapp
dta <- loanapp
dta$actioon %>% plto()
dta$action %>% plto()
dta$action %>% plot()
dta$approve %>% plot()
dta %>%
gggplot(aes(x = emp, y = approve)) +
geom_point()
dta %>%
ggplot(aes(x = emp, y = approve)) +
geom_point()
dta %>%
ggplot(aes(x = yjob, y = approve)) +
geom_point()
View(dta)
dta %>%
ggplot(aes(x = loanamt, y = approve)) +
geom_point()
View(dta)
dta %>%
mutate(inccoef = appinc / loanamt) %>%
ggplot(aes(x = inccoef, y = approve)) +
geom_point()
dta %>%
filter(inccoef > 10)
dta %>%
mutate(inccoef = appinc / loanamt) %>%
filter(inccoef > 10)
dta %>%
mutate(inccoef = appinc / loanamt) %>%
ggplot(aes(x = inccoef, y = approve, fill = pubrec)) +
geom_point()
dta %>%
mutate(inccoef = appinc / loanamt) %>%
ggplot(aes(x = inccoef, y = approve, fill = pubrec, color = pubrec)) +
geom_point()
dta %>%
mutate(inccoef = appinc / loanamt) %>%
ggplot(aes(x = inccoef, y = approve, color = pubrec)) +
geom_point()
dta %>%
mutate(inccoef = appinc / loanamt) %>%
ggplot(aes(x = inccoef, y = approve, color = pubrec)) +
geom_point(show.legend = F)
dta %>%
mutate(inccoef = appinc / loanamt) %>%
mutate(pubrec = as.factor(pubrec)) %>%
ggplot(aes(x = inccoef, y = approve, color = pubrec)) +
geom_point(show.legend = F)
dta %>%
mutate(inccoef = appinc / loanamt) %>%
mutate(pubrec = as.factor(pubrec)) %>%
ggplot(aes(x = inccoef, y = approve, color = pubrec)) +
geom_point(show.legend = F) +
geom_smooth(method = 'ols')
dta %>%
mutate(inccoef = appinc / loanamt) %>%
mutate(pubrec = as.factor(pubrec)) %>%
ggplot(aes(x = inccoef, y = approve, color = pubrec)) +
geom_point(show.legend = F) +
geom_smooth(method = 'lm')
dta %>%
mutate(inccoef = appinc / loanamt) %>%
mutate(pubrec = as.factor(pubrec)) %>%
ggplot(aes(x = inccoef, y = approve)) +
geom_point(show.legend = F) +
geom_smooth(method = 'lm')
?geom_smooth
dta %>%
mutate(inccoef = appinc / loanamt) %>%
mutate(pubrec = as.factor(pubrec)) %>%
ggplot(aes(x = inccoef, y = approve)) +
geom_point(show.legend = F) +
geom_smooth(formula = approve ~ inccoef, method = 'lm')
dta %>%
mutate(inccoef = appinc / loanamt) %>%
mutate(pubrec = as.factor(pubrec)) %>%
ggplot(aes(x = inccoef, y = approve)) +
geom_point(show.legend = F) +
geom_smooth(formula = y ~ x, method = 'lm')
dta %>%
mutate(inccoef = appinc / loanamt) %>%
mutate(pubrec = as.factor(pubrec)) %>%
ggplot(aes(x = inccoef, y = approve)) +
geom_point(show.legend = F) +
geom_smooth(formula = y ~ x + pubrec, method = 'lm')
dta %>%
mutate(inccoef = appinc / loanamt) %>%
mutate(pubrec = as.factor(pubrec)) %>%
ggplot(aes(x = inccoef, y = approve, color = pubrec)) +
geom_point(show.legend = F) +
geom_smooth(formula = y ~ x + color, method = 'lm')
dta %>%
mutate(inccoef = appinc / loanamt) %>%
mutate(pubrec = as.factor(pubrec)) %>%
ggplot(aes(x = inccoef, y = approve, color = pubrec)) +
geom_point(show.legend = F) +
geom_smooth(formula = y ~ x, method = 'lm')
dta <- dta %>%
mutate(inccoef = appinc / loanamt) %>%
mutate(pubrec = as.factor(pubrec))
mod_ols <- lm(approve ~ inccoef, dta)
stargazer(mod_ols)
stargazer(mod_ols, type = 'text')
mod_ols1 <- lm(approve ~ inccoef + pubrec)
mod_ols1 <- lm(approve ~ inccoef + pubrec, dta)
stargazer(mod_ols, type = 'text')
stargazer(mod_ols, mod_ols1 type = 'text')
stargazer(mod_ols, mod_ols1, type = 'text')
mod_logistic <- glm(approve ~ inccoef, family = binomial)
mod_logistic <- glm(approve ~ inccoef, family = binomial, dta)
stargazer(mod_ols, mod_ols1, mod_logisticc type = 'text')
stargazer(mod_ols, mod_ols1, mod_logistic, type = 'text')
mod_logistic1 <- glm(approve ~ inccoef + pubrec, family = binomial, dta)
stargazer(mod_ols, mod_ols1, mod_logistic, mod_logistic1 type = 'text')
stargazer(mod_ols, mod_ols1, mod_logistic, mod_logistic1, type = 'text')
mod_logistic2 <- glm(approve ~ inccoef + pubrec + black + male + hispan + old + married, family = binomial, dta)
stargazer(mod_ols, mod_ols1, mod_logistic, mod_logistic1, type = 'text')
stargazer(mod_ols, mod_ols1, mod_logistic, mod_logistic1, mod_logistic2, type = 'text')
mod_logistic2 <- glm(approve ~ appinc + pubrec + black + male + hispan + old + married, family = binomial, dta)
stargazer(mod_ols, mod_ols1, mod_logistic, mod_logistic1, mod_logistic2, type = 'text')
plot(mod_logistic)
1 / (1 + e^-(1.995 - 0.041))
1 / (1 + 1e^-(1.995 - 0.041))
1 / (1 + exp(-(1.995 - 0.041)))
inccoed
inccoef
dta$inccoef
x = seq(0, 3, by = 0.1)
y = 1 / (1 + exp(-(1.995 - 0.041 * x)))
tibble(x, y) %>%
ggplot(aes(x = x, y = y)) +
geom_line
tibble(x, y) %>%
ggplot(aes(x = x, y = y)) +
geom_line()
stargazer(mod_ols, mod_ols1, mod_logistic, mod_logistic1, mod_logistic2, type = 'text')
mod_logistic2 <- glm(approve ~ inccoef + appinc + pubrec + black + male + hispan + old + married, family = binomial, dta)
stargazer(mod_ols, mod_ols1, mod_logistic, mod_logistic1, mod_logistic2, type = 'text')
x = seq(0, 1, by = 1)
y = 1 / (1 + exp(-(1.995 - 1.796 * x)))
tibble(x, y) %>%
ggplot(aes(x = x, y = y)) +
geom_line()
setwd("C:/Users/evgen/econometrics_2023/HW3")
dta <- read_csv('framingham.csv')
View(dta)
dta
colnames(dta)
dta %>%
ggplot(aes(x = glucose, y = diabetes)) +
geom_point()
dta %>%
ggplot(aes(x = glucose, y = diabetes)) +
geom_point()
dta %>%
ggplot(aes(x = glucose, y = diabetes)) +
geom_point() +
geom_vline(xintercept = 99, color = 'red')
dta %>%
ggplot(aes(x = glucose, y = diabetes)) +
geom_point() +
geom_vline(xintercept = 99, color = 'red', type = 'dashed')
library(hrbrthemes)
dta %>%
ggplot(aes(x = glucose, y = diabetes)) +
geom_point() +
geom_vline(xintercept = 99, color = 'red') +
theme_ipsum()
library(hrbrthemes)
dta %>%
ggplot(aes(x = glucose, y = diabetes)) +
geom_point() +
geom_vline(xintercept = 99, color = 'red') +
theme_ipsum()
dta %>%
ggplot(aes(x = glucose, y = diabetes)) +
geom_point() +
geom_vline(xintercept = 99, color = 'red') +
hrbrthemes::theme_ipsum()
