---
title: "Лекция 0"
author: "Е. Тымченко"
date: 2023-04-18
categories: ["R"]
tags: ["Перые шаги"]
---

```{r, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE)
library(tidyverse)
library(palmerpenguins) # need to install
library(broom) 
library(skimr) # need to install
library(bslib) # need to install
library(knitr)
library(DT)
```

```{r setup, include=FALSE}
knitr::opts_chunk$set(collapse = TRUE)
```

# Манипуляция данными и статистика в R 

Это мой первый опыт в создании и редактировании сайта.

<center>

![Надеюсь, у вас хорошее настроение.](https://github.com/ETymch/Econometrics_2023/blob/d4b9c5d0f14136c1a35aebfe5dddf1265cd323a5/Pics/dancing.gif?raw=true)

</center>

> Однажды на конференции по математической статистике один из участников гордо заявил, что его метод имеет "p-value" на уровне значимости меньше 0,0001. Внезапно из зала послышался голос другого участника, который спросил: "А что такое p-value?" Первый участник перестал уверенно улыбаться и начал объяснять сущность этого статистического понятия. Его описание было настолько запутанным и непонятным, что зал начал смеяться. Второй участник поднял руку и сказал: "Спасибо за объяснение, теперь я понимаю, что p-value - это как раз то, чего я не хочу получить в своих экспериментах!"

> Анекдот от Chat GPT.

В курсе мы будем использовать язык программирования `R`. Он относительно простой и удобный, а главное - бесплатный! Мы познакомимся с:

* `Tidyverse` - пожалуй, самой удобной на сегодня библиотекой для  манипуляции данными
* `Stats` - уже включённой в `R` библиотекой для статистического моделирования

Давайте напишем самую простую программу:

```{r}
print('Hello World!')
```

У нас есть данные по различным сборкам ноутбуков и их ценам. Давайте потренируемся обрабатывать данные этом примере. В будущих лекциях мы построим модель ценообразования на рынке ноутбуков (это поможет нам найти самые недооценённые ноутбуки и сформировать свой высокодоходный портфель ноутбуков)!

```{r}
data <- read.csv('https://raw.githubusercontent.com/ETymch/Econometrics_2023/main/Datasets/laptop_price.csv')
data %>%
  group_by(Company) %>%
  head()
```

Когда мы пишем код в `R` мы часто импользуем `%>%` - трубочки. Всё просто: допустим мы хотим последовательно применить к объекту несколько функций. Помните, в курсе по математике были вложенные функции $f(g(x))$? Тогда это значило, что к объекту $x$ мы сначала применяли функцию $g$, затем функцию $f$. При помощи `%>%` мы можем написать это так: `x %>% g() %>% f()`. Хороший тон - писать такие функции в столбик - тогда код удобно читать. Если мы захотим последовательно применить много функций (для манипуляции сложным объектом), то код, написанный первым подходом становится нечитаемым. Например: `datatable(head(group_by(Data, Company)))`.

Давайте посмотрим, какие бренды предствалены в выборке:

```{r}
data$Company %>%
  as.factor() %>%
  plot(main = 'Бренды в выборке')
```

Давайте посмотрим на распределение цен в выборке:

```{r}
data$Price_euros %>%
  hist(main = 'Распределение цен ноутбуков')
```

На графике заметно, что есть какие-то супердорогие ноутбуки, которые стоят более 4k евро! Давайте посмотрим на них.

```{r}
data %>%
  filter(Price_euros >= 4000)
```

## Оптимизация

В вступительном тесте у вас была задача оптимизации. $$\min_x{(3-3x)^2}$$.
Иначе говоря, мы хотим найти такой $x$, чтобы интересующая нас функция $(3-3x)^2$ приняла минимальное значение. Есть несколько способов её решить.

* Из школьного курса мы помним, что $(3-3x)^2$ - вогнутая парабола (с ветками вверх). Значит она имеет 1 решение, догадаться до которого просто, при $x = 1$ функция принимает значение 0.
* Взяв производную, мы найдём точку, в которой касателььная к графику параллельна оси функции.
$$[(3-3x)^2]' 
= -12(3-3x)
= 0$$
Следовательно $x = 1$. Искомая функция принимает значение 1.
* Мы можем быстро запрограммировать этот пример. Помните, в этом курсе использование компьютера поощряется *всегда*. Напишем функцию:
```{r}
f <- function(x){
  (3 - 3*x)^2
}
```
Нарисуем её на промежутке [-5;5]:
```{r}
x = seq(-5, 5, by = 0.01)
plot(x, f(x), col = 'lightblue')
```
Да, очевидно это вогнутая парабола. Найдём минимум:

```{r}
optimize(f, x)
```
Функция принимает минимальное значение 0 при $x = 1$

Мы решили задачу оптимизации!

<center>

![Ура!](https://github.com/ETymch/Econometrics_2023/blob/main/Pics/celebration.gif?raw=true)

</center>

Теперь ваш чёрёд! Решите аналитически и при помощи R, постройте график:
$$\max_x\{3 - 10x - 2x^2\}$$