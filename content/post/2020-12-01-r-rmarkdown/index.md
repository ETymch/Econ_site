---
title: "Лекция 0"
author: "Е. Тымченко"
date: 2023-04-18
categories: ["R"]
tags: ["Первые шаги"]
---





# Манипуляция данными и статистика в **R** 

Это мой первый опыт в создании и редактировании сайта. В ближайшее время я буду вносить изменения в формат и в содержание постов, но пока так.

<center>

![Надеюсь, у вас хорошее настроение.](https://github.com/ETymch/Econometrics_2023/blob/d4b9c5d0f14136c1a35aebfe5dddf1265cd323a5/Pics/dancing.gif?raw=true)

</center>

В курсе мы будем использовать язык **R**. Он относительно простой и удобный, а главное - бесплатный! Если вы его ещё не установили - [самое время это сделать по ссылке!](https://cran.r-project.org/bin/windows/base/) После установки **R** необходимо поставить экосистему [**RStudio** - она очень удобная и сделает знакомство с **R** наиболее безболезненным](https://posit.co/downloads/). Когда вы впервые запустите **RStudio**, создайте рабочее пространство, кликните на верхней панели `Session` -> `Set Working Directory` -> `Choose Directory`. Теперь ваш код и файлы с данными для этого курса никуда не потеряются. Самое время начать знакомство с **R**!

Обычно в начале требуется какое-то вступительное слово, но у меня его нет. Поэтому начнём мы с анекдота от искусственного интеллекта: 

> Однажды на конференции по математической статистике один из участников гордо заявил, что его метод имеет "p-value" на уровне значимости меньше 0,0001. Внезапно из зала послышался голос другого участника, который спросил: "А что такое p-value?" Первый участник перестал уверенно улыбаться и начал объяснять сущность этого статистического понятия. Его описание было настолько запутанным и непонятным, что зал начал смеяться. Второй участник поднял руку и сказал: "Спасибо за объяснение, теперь я понимаю, что p-value - это как раз то, чего я не хочу получить в своих экспериментах!"

> Анекдот про эконометрику от Chat GPT.

Сегодня познакомимся с:

* `Tidyverse` - пожалуй, самой удобной на сегодня библиотекой для манипуляции данными
* `Stats` - уже включённой в **R** библиотекой для статистического моделирования

Давайте напишем самую простую программу:


```r
print('Hello World!')
## [1] "Hello World!"
```

У нас есть данные по различным сборкам ноутбуков и их ценам. Давайте потренируемся обрабатывать данные этом примере. В будущих лекциях мы построим модель ценообразования на рынке ноутбуков (это поможет нам найти самые недооценённые ноутбуки и сформировать свой высокодоходный портфель ноутбуков)!


```r
data <- read.csv('https://raw.githubusercontent.com/ETymch/Econometrics_2023/main/Datasets/laptop_price.csv')
data %>%
  group_by(Company) %>%
  head()
## # A tibble: 6 × 13
## # Groups:   Company [3]
##   laptop_ID Company Product  TypeName Inches ScreenResolution Cpu   Ram   Memory
##       <int> <chr>   <chr>    <chr>     <dbl> <chr>            <chr> <chr> <chr> 
## 1         1 Apple   MacBook… Ultrabo…   13.3 IPS Panel Retin… Inte… 8GB   128GB…
## 2         2 Apple   Macbook… Ultrabo…   13.3 1440x900         Inte… 8GB   128GB…
## 3         3 HP      250 G6   Notebook   15.6 Full HD 1920x10… Inte… 8GB   256GB…
## 4         4 Apple   MacBook… Ultrabo…   15.4 IPS Panel Retin… Inte… 16GB  512GB…
## 5         5 Apple   MacBook… Ultrabo…   13.3 IPS Panel Retin… Inte… 8GB   256GB…
## 6         6 Acer    Aspire 3 Notebook   15.6 1366x768         AMD … 4GB   500GB…
## # ℹ 4 more variables: Gpu <chr>, OpSys <chr>, Weight <chr>, Price_euros <dbl>
```

Когда мы пишем код в **R** мы часто используем `%>%` - трубочки. Всё просто: допустим мы хотим последовательно применить к объекту несколько функций. Помните, в курсе по математике были вложенные функции `\(f(g(x))\)`? Тогда это значило, что к объекту `\(x\)` мы сначала применяли функцию `\(g\)`, затем функцию `\(f\)`. При помощи `%>%` мы можем написать это так: `x %>% g() %>% f()`. Хороший тон - писать такие функции в столбик - тогда код удобно читать. Если мы захотим последовательно применить много функций (для манипуляции сложным объектом), то код, написанный первым подходом становится нечитаемым. Например: `datatable(head(group_by(Data, Company)))`.

Давайте посмотрим, какие бренды представлены в выборке:


```r
data$Company %>%
  as.factor() %>%
  plot(main = 'Бренды в выборке')
```

<img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-4-1.png" width="672" />

Давайте посмотрим на распределение цен в выборке:


```r
data$Price_euros %>%
  hist(main = 'Распределение цен ноутбуков')
```

<img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-5-1.png" width="672" />

На графике заметно, что есть какие-то супердорогие ноутбуки, которые стоят более 4k евро! Давайте посмотрим на них.


```r
data %>%
  filter(Price_euros >= 4000)
##   laptop_ID Company      Product    TypeName Inches
## 1       200   Razer    Blade Pro      Gaming   17.3
## 2       617  Lenovo Thinkpad P51    Notebook   15.6
## 3       758      HP     Zbook 17 Workstation   17.3
## 4       839   Razer    Blade Pro      Gaming   17.3
##                      ScreenResolution                           Cpu  Ram
## 1 4K Ultra HD / Touchscreen 3840x2160   Intel Core i7 7820HK 2.9GHz 32GB
## 2     IPS Panel 4K Ultra HD 3840x2160 Intel Xeon E3-1535M v6 3.1GHz 32GB
## 3         IPS Panel Full HD 1920x1080 Intel Xeon E3-1535M v5 2.9GHz 16GB
## 4 4K Ultra HD / Touchscreen 3840x2160   Intel Core i7 7820HK 2.9GHz 32GB
##      Memory                     Gpu      OpSys Weight Price_euros
## 1   1TB SSD Nvidia GeForce GTX 1080 Windows 10 3.49kg        6099
## 2   1TB SSD    Nvidia Quadro M2200M Windows 10  2.5kg        4899
## 3 256GB SSD    Nvidia Quadro M2000M  Windows 7    3kg        4389
## 4 512GB SSD Nvidia GeForce GTX 1080 Windows 10 3.49kg        5499
```

## Оптимизация

В вступительном тесте у вас была задача оптимизации. `$$\min_x{(3-3x)^2}$$`
Иначе говоря, мы хотим найти такой `\(x\)`, чтобы интересующая нас функция `\((3-3x)^2\)` приняла минимальное значение. Есть несколько способов её решить.

* Из школьного курса мы помним, что `\((3-3x)^2\)` - вогнутая парабола (с ветками вверх). Значит она имеет 1 решение, догадаться до которого просто, при `\(x = 1\)` функция принимает значение 0.
* Взяв производную, мы найдём точку, в которой касательная к графику параллельна оси функции.
`$$[(3-3x)^2]' 
= -12(3-3x)
= 0$$`
Следовательно, `\(x = 1\)`. Искомая функция принимает значение 1.
* Мы можем быстро запрограммировать этот пример. Помните, в этом курсе использование компьютера поощряется **всегда**. Напишем функцию:

```r
f <- function(x){
  (3 - 3*x)^2
}
```
Нарисуем её на промежутке [-5;5]:

```r
x = seq(-5, 5, by = 0.01)
plot(x, f(x), col = 'lightblue')
```

<img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-8-1.png" width="672" />
Да, очевидно это вогнутая парабола. Найдём минимум:


```r
optimize(f, x)
## $minimum
## [1] 1
## 
## $objective
## [1] 0
```
Функция принимает минимальное значение 0 при `\(x = 1\)`

Мы решили задачу оптимизации!

<center>

![Ура!](https://github.com/ETymch/Econometrics_2023/blob/main/Pics/celebration.gif?raw=true)

</center>

Теперь ваш черёд! Решите аналитически и при помощи **R**, постройте график:
`$$\max_x\{3 - 10x - 2x^2\}$$`
